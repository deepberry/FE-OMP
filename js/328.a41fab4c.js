"use strict";(self["webpackChunkomp"]=self["webpackChunkomp"]||[]).push([[328],{6328:function(e,a,t){t.r(a),t.d(a,{default:function(){return y}});var o=t(6252),n=t(2262),s=t(2201),c=t(2908),r=t(6146);function i(){return(0,r.u)().get("/api/Work/userInfo")}function l(e){return(0,r.u)().get(`/api/Manage/uer/${e}/role`)}var u=t(1575),d=t(8825);const p=e=>((0,o.dD)("data-v-dfde104c"),e=e(),(0,o.Cn)(),e),m={class:"v-home"},f=["src"],h=p((()=>(0,o._)("span",{class:"title"},"深莓智能运营管理平台",-1))),g={key:0,class:"desc"},v=(0,o.Uk)("连接失败，请再次尝试，或联系管理人员");var k={__name:"HomeView",setup(e){const a=(0,s.yj)(),t=(0,s.tv)(),r=(0,d.t)();let{role:p}=(0,u.Jk)(r);console.log(p);const k="ww5429d07e97752284",_=`https://open.weixin.qq.com/connect/oauth2/authorize?appid=${k}&redirect_uri=${encodeURIComponent(location.href)}&response_type=code&scope=snsapi_base&state=STATE#wechat_redirect`,w=(0,n.iH)(""),y=(0,n.qj)({fail:!1});return(0,o.YP)(a,(e=>{w.value=e.query.code}),{deep:!0,immediate:!0}),(0,o.YP)(w,(e=>{console.log(e),e&&i({code:e}).then((e=>{y.fail=!1,localStorage.setItem("token",JSON.stringify(e.data.accessToken)),l(e.data.userId).then((e=>{p=e.data.viewPermissoins,r.role=p,console.log(p),p.value.length?t.push({name:"company"}):t.push({name:"details",params:{type:"role",id:0}})}))})).catch((e=>{console.log(e),y.fail=!0}))}),{deep:!0,immediate:!0}),(e,a)=>{const t=(0,o.up)("Warning");return(0,o.wg)(),(0,o.iD)("div",m,[(0,o._)("img",{class:"logo",src:(0,n.SU)(c),alt:"深莓智能"},null,8,f),h,(0,o._)("a",{href:_,class:"button"},"点击进入"),y.fail?((0,o.wg)(),(0,o.iD)("span",g,[(0,o.Wm)(t,{class:"icon"}),v])):(0,o.kq)("",!0)])}}},_=t(3744);const w=(0,_.Z)(k,[["__scopeId","data-v-dfde104c"]]);var y=w}}]);
//# sourceMappingURL=328.a41fab4c.js.map