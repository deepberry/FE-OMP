"use strict";(self["webpackChunkomp"]=self["webpackChunkomp"]||[]).push([[962],{2941:function(e,a,t){t.d(a,{ji:function(){return n},lQ:function(){return i},m_:function(){return o},mz:function(){return s},oS:function(){return r}});var l=t(6146);function o(e){return(0,l.u)().get("/api/Orgz",{params:e})}function i(e){return(0,l.u)().post("/api/Orgz",e)}function n(e){return(0,l.u)().put("/api/Orgz",e)}function s(e,a){return(0,l.u)().put(`/api/Orgz/${e}/enabled/${a}`)}function r(e){return(0,l.u)().get(`/api/Orgz/${e}`)}},3962:function(e,a,t){t.r(a),t.d(a,{default:function(){return I}});var l=t(6252),o=t(2262),i=t(3577),n=t(4239);const s={class:"u-table-img"},r=["src"],u={class:"u-table-button"},d=(0,l.Uk)("编辑"),m=(0,l.Uk)("查看详情 ");var p={__name:"companyTable",props:{table:Array,label:String},emits:["toDialog"],setup(e,{emit:a}){const t=e;let n=(0,o.qj)({data:[]});const p="https://www.deepberry.cn/images/placeholders/logo.png";function c(e,t){a("toDialog",{row:e,type:t})}return(0,l.YP)(t,(e=>{n.data=e.table}),{deep:!0}),(a,t)=>{const g=(0,l.up)("el-table-column"),b=(0,l.up)("el-button"),f=(0,l.up)("router-link"),w=(0,l.up)("el-table");return(0,l.wg)(),(0,l.j4)(w,{class:"m-table",data:(0,o.SU)(n).data,border:"",style:{width:"100%"}},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{prop:"organizationId",label:"企业ID",width:"120"}),(0,l.Wm)(g,{prop:"orgzName",label:"企业名称"}),(0,l.Wm)(g,{label:"企业Logo"},{default:(0,l.w5)((e=>[(0,l._)("div",s,[(0,l._)("img",{src:e.row.orgzLogo||p},null,8,r)])])),_:1}),(0,l.Wm)(g,{prop:"userName",label:"联系人",width:"200"}),(0,l.Wm)(g,{prop:"phoneNum",label:"手机号码",width:"200"}),(0,l.Wm)(g,{label:"企业状态",width:"120"},{default:(0,l.w5)((e=>[(0,l._)("span",{class:(0,i.C_)("禁用"===e.row.status?"u-table-disabled":"u-table-normal")},(0,i.zw)(e.row.status),3)])),_:1}),(0,l.Wm)(g,{prop:"createAt",label:"账户创建时间",width:"240"}),(0,l.Wm)(g,{label:"操作",width:"280"},{default:(0,l.w5)((a=>[(0,l._)("div",u,[(0,l.Wm)(b,{link:"",type:"primary",size:"small",onClick:e=>c(a.row,"close")},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)("正常"==a.row.status?"停用":"启用"),1)])),_:2},1032,["onClick"]),(0,l.Wm)(b,{link:"",type:"primary",size:"small",onClick:e=>c(a.row,"edit")},{default:(0,l.w5)((()=>[d])),_:2},1032,["onClick"]),(0,l.Wm)(f,{to:{path:`/${e.label}/details/${a.row.organizationId}`},class:"u-table-more"},{default:(0,l.w5)((()=>[m])),_:2},1032,["to"])])])),_:1})])),_:1},8,["data"])}}},c=t(3744);const g=(0,c.Z)(p,[["__scopeId","data-v-63c3ac75"]]);var b=g;const f={class:"m-box"},w=(0,l._)("div",{class:"u-tips"},[(0,l._)("span",null," 尺寸建议：宽180 x 高60"),(0,l._)("span",null," 格式建议：透明背景图片，PNG或gif,logo图形使用深色")],-1),_={key:0,class:"dialog-footer"},h={emits:["dialogClose","dialogSuccess"]};var y=Object.assign(h,{__name:"companyFormDialog",props:{dialogObject:Object},setup(e,{emit:a}){const t=e,n=(0,l.Fl)((()=>t.dialogObject.company));let s=(0,o.qj)({form:{}});const r=(0,o.iH)(""),u=(0,o.iH)({phoneNum:[{required:!0,message:"请输入联系人手机号码",trigger:"blur"},{pattern:/^1[3456789]\d{9}$/,message:"手机号码格式不正确",trigger:"blur"}],orgzName:[{required:!0,message:"请输入企业名称",trigger:"blur"}],userName:[{required:!0,message:"请输入企业联系人",trigger:"blur"}]}),d=(0,l.Fl)({get(){return t.dialogObject.dialogVisible},set(e){return e}}),m={dialogTitle:t.dialogObject.title||"企业信息",dialogWidth:t.dialogObject.width||"780px",dialogCloseBtnText:t.dialogObject.closeBtnText||"取消",dialogSuccessBtnText:t.dialogObject.successBtnText||"确定",dialogIsFooter:t.dialogObject.isFooter||!0};(0,l.YP)(n,(e=>{s.form=e.add?{}:e}),{deep:!0,immediate:!0});const p=e=>{a("dialogClose"),e.validate&&e.resetFields()},c=e=>{e&&e.validate(((e,t)=>{e?a("dialogSuccess",s.form):console.log("error submit!",t)}))};return(e,a)=>{const t=(0,l.up)("el-input"),n=(0,l.up)("el-form-item"),g=(0,l.up)("UploadImage"),b=(0,l.up)("el-form"),h=(0,l.up)("el-button"),y=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l.Wm)(y,{modelValue:(0,o.SU)(d),"onUpdate:modelValue":a[5]||(a[5]=e=>(0,o.dq)(d)?d.value=e:null),title:m.dialogTitle,width:m.dialogWidth,"before-close":p,draggable:""},{footer:(0,l.w5)((()=>[m.dialogIsFooter?((0,l.wg)(),(0,l.iD)("span",_,[(0,l.Wm)(h,{onClick:a[3]||(a[3]=e=>p(r.value))},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(m.dialogCloseBtnText),1)])),_:1}),(0,l.Wm)(h,{type:"primary",onClick:a[4]||(a[4]=e=>c(r.value))},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(m.dialogSuccessBtnText),1)])),_:1})])):(0,l.kq)("",!0)])),default:(0,l.w5)((()=>[(0,l.Wm)(b,{class:"m-form-content",ref_key:"formRef",ref:r,model:(0,o.SU)(s).form,rules:u.value,"label-width":"120px"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{label:"企业名称",prop:"orgzName"},{default:(0,l.w5)((()=>[(0,l.Wm)(t,{modelValue:(0,o.SU)(s).form.orgzName,"onUpdate:modelValue":a[0]||(a[0]=e=>(0,o.SU)(s).form.orgzName=e)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(n,{label:"企业/组织Logo"},{default:(0,l.w5)((()=>[(0,l._)("div",f,[(0,l.Wm)(g,{class:"m-uploader"}),w])])),_:1}),(0,l.Wm)(n,{label:"联系人",prop:"userName"},{default:(0,l.w5)((()=>[(0,l.Wm)(t,{modelValue:(0,o.SU)(s).form.userName,"onUpdate:modelValue":a[1]||(a[1]=e=>(0,o.SU)(s).form.userName=e)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(n,{label:"手机号码",prop:"phoneNum"},{default:(0,l.w5)((()=>[(0,l.Wm)(t,{modelValue:(0,o.SU)(s).form.phoneNum,"onUpdate:modelValue":a[2]||(a[2]=e=>(0,o.SU)(s).form.phoneNum=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title","width"])])}}});const z=y;var S=z,U=t(2941),v=t(9996);const W={class:"v-company v-page"},k={class:"m-search-box"},j=(0,l.Uk)("企业开户"),N={class:"m-tips-content"},C=(0,l._)("span",{class:"u-title"},"是否启用/停用企业账户",-1);var V={__name:"CompanyList",setup(e){const a=(0,n.t)(),{label:t}=a,s={placeholder:"请输入企业ID/企业名称/联系人/联系电话",status_title:"-- 企业账户状态 --",status:[{label:"全部",value:-1},{label:"正常",value:0},{label:"已停用",value:1}]};let r=(0,o.qj)({loading:!1,table:[],pagination:{page:1,per:20,total:0},search:{input:null,status:null},form:{}});const u=(0,l.Fl)((()=>({pageIndex:r.pagination.page-1,pageSize:r.pagination.per,Condition:r.search.input,Status:r.search.status}))),d={organizationId:"",orgzLogo:"",orgzName:"",phoneNum:"",userId:"",userName:""};let m=(0,o.iH)("form"),p=(0,o.qj)({dialogVisible:!1,company:d});function c({input_txt:e,status_id:a}){r.search.input=e,r.search.status=-1==a?null:a,r.pagination.page=1,y()}function g(e){r.pagination.page=e,y()}function f({row:e,type:a}){p.dialogVisible=!0;const t=e||d;"add"==a&&(t.add=!0),p.company=t,m.value="close"==a?"tips":"form"}const w=()=>{p.dialogVisible=!1},_=()=>{const{organizationId:e,status:a}=p.company,t="正常"==a?1:0,l=0==t?"启用":"停用";(0,U.mz)(e,t).then((()=>{p.dialogVisible=!1,y(),(0,v.bM)({title:"成功",message:`${l}企业成功`,type:"success"})}))},h=e=>{p.dialogVisible=!1,e.logo=e.orgzLogo,e.organizationId?(0,U.ji)(e).then((()=>{(0,v.bM)({title:"成功",message:"修改企业信息成功",type:"success"})})):(0,U.lQ)(e).then((()=>{(0,v.bM)({title:"成功",message:"添加企业成功",type:"success"})}))};function y(){r.loading=!0,(0,U.m_)(u.value).then((e=>{if("200"==e.status){const a=e.data.data;r.table=a.datas,r.pagination.total=a.totalCount}})).finally((()=>r.loading=!1))}return(0,l.bv)((()=>y())),(e,a)=>{const n=(0,l.up)("search-bar"),u=(0,l.up)("el-button"),d=(0,l.up)("commonPagination"),y=(0,l.up)("tipsDialog"),z=(0,l.Q2)("loading");return(0,l.wg)(),(0,l.iD)("div",W,[(0,l._)("div",k,[(0,l.Wm)(n,{data:s,onToSearch:c}),(0,l.Wm)(u,{class:"u-add",type:"primary",onClick:a[0]||(a[0]=e=>f({type:"add"}))},{default:(0,l.w5)((()=>[j])),_:1})]),(0,l.wy)((0,l.Wm)((0,o.SU)(b),{table:(0,o.SU)(r).table,label:(0,o.SU)(t),onToDialog:f},null,8,["table","label"]),[[z,(0,o.SU)(r).loading]]),(0,l.Wm)(d,{pagination:(0,o.SU)(r).pagination,onToParams:g},null,8,["pagination"]),"tips"==(0,o.SU)(m)?((0,l.wg)(),(0,l.j4)(y,{key:0,class:"m-tips","dialog-object":(0,o.SU)(p),onDialogClose:w,onDialogSuccess:_},{default:(0,l.w5)((()=>[(0,l._)("div",N,[C,(0,l._)("span",null,(0,i.zw)((0,o.SU)(p).company.orgzName),1),(0,l._)("span",null,"企业ID: "+(0,i.zw)((0,o.SU)(p).company.organizationId),1)])])),_:1},8,["dialog-object"])):(0,l.kq)("",!0),"form"==(0,o.SU)(m)?((0,l.wg)(),(0,l.j4)((0,o.SU)(S),{key:1,class:"m-form","dialog-object":(0,o.SU)(p),onDialogClose:w,onDialogSuccess:h},null,8,["dialog-object"])):(0,l.kq)("",!0)])}}};const D=V;var I=D}}]);
//# sourceMappingURL=962.c4bcc750.js.map