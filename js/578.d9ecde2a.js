"use strict";(self["webpackChunkomp"]=self["webpackChunkomp"]||[]).push([[578],{2941:function(e,a,l){l.d(a,{ji:function(){return i},lQ:function(){return n},m_:function(){return o},mz:function(){return s},oS:function(){return u},yG:function(){return r}});var t=l(6146);function o(e){return(0,t.u)().get("/api/Orgz",{params:e})}function n(e){return(0,t.u)().post("/api/Orgz",e)}function i(e){return(0,t.u)().put("/api/Orgz",e)}function s(e,a){return(0,t.u)().put(`/api/Orgz/${e}/enabled/${a}`)}function u(e){return(0,t.u)().get(`/api/Orgz/${e}`)}function r(){return(0,t.u)().get("/api/Orgz/total")}},7578:function(e,a,l){l.r(a),l.d(a,{default:function(){return O}});l(6699);var t=l(6252),o=l(2262),n=l(3577),i=l(8825),s=l(1575);const u={class:"u-table-img"},r=["src"],d={class:"u-table-button"},c=(0,t.Uk)("编辑"),g=(0,t.Uk)("查看详情 ");var p={__name:"companyTable",props:{table:Array,label:String},emits:["toDialog"],setup(e,{emit:a}){const l=e,p=(0,i.t)(),{role:m}=(0,s.Jk)(p),b=(0,t.Fl)((()=>m.value.includes(13))),f=(0,t.Fl)((()=>m.value.includes(12))),w=(0,t.Fl)((()=>m.value.includes(10))),_=[10,12,13],S=(0,t.Fl)((()=>m.value.map((e=>_.includes(e))).filter(Boolean).length));let U=(0,o.qj)({data:[]});const h="https://www.deepberry.cn/images/placeholders/logo.png";function k(e,l){a("toDialog",{row:e,type:l})}return(0,t.YP)(l,(e=>{U.data=e.table}),{deep:!0}),(a,l)=>{const i=(0,t.up)("el-table-column"),s=(0,t.up)("el-button"),p=(0,t.up)("router-link"),m=(0,t.up)("el-table");return(0,t.wg)(),(0,t.j4)(m,{class:"m-table",data:(0,o.SU)(U).data,border:"",fit:"",style:{width:"100%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{prop:"organizationId",label:"企业ID",width:"120"}),(0,t.Wm)(i,{prop:"orgzName",label:"企业名称"}),(0,t.Wm)(i,{label:"企业Logo"},{default:(0,t.w5)((e=>[(0,t._)("div",u,[(0,t._)("img",{src:e.row.orgzLogo||h},null,8,r)])])),_:1}),(0,t.Wm)(i,{prop:"userName",label:"联系人",width:"200"}),(0,t.Wm)(i,{prop:"phoneNum",label:"手机号码",width:"200"}),(0,t.Wm)(i,{label:"企业状态",width:"120"},{default:(0,t.w5)((e=>[(0,t._)("span",{class:(0,n.C_)("禁用"===e.row.status?"u-table-disabled":"u-table-normal")},(0,n.zw)("禁用"===e.row.status?"已停用":e.row.status),3)])),_:1}),(0,t.Wm)(i,{prop:"createAt",label:"账户创建时间",width:"240"}),(0,o.SU)(S)?((0,t.wg)(),(0,t.j4)(i,{key:0,label:"操作",width:"280"},{default:(0,t.w5)((a=>[(0,t._)("div",d,[(0,o.SU)(w)?((0,t.wg)(),(0,t.j4)(s,{key:0,link:"",type:"primary",size:"small",onClick:e=>k(a.row,"close")},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)("正常"==a.row.status?"停用":"启用"),1)])),_:2},1032,["onClick"])):(0,t.kq)("",!0),(0,o.SU)(b)?((0,t.wg)(),(0,t.j4)(s,{key:1,link:"",type:"primary",size:"small",onClick:e=>k(a.row,"edit")},{default:(0,t.w5)((()=>[c])),_:2},1032,["onClick"])):(0,t.kq)("",!0),(0,o.SU)(f)&&a.row.organizationId?((0,t.wg)(),(0,t.j4)(p,{key:2,to:{path:`/${e.label}/details/${a.row.organizationId}`},class:"u-table-more"},{default:(0,t.w5)((()=>[g])),_:2},1032,["to"])):(0,t.kq)("",!0)])])),_:1})):(0,t.kq)("",!0)])),_:1},8,["data"])}}},m=l(3744);const b=(0,m.Z)(p,[["__scopeId","data-v-390c384c"]]);var f=b;const w={class:"m-box"},_=(0,t._)("div",{class:"u-tips"},[(0,t._)("span",null," 尺寸建议：宽180 x 高60"),(0,t._)("span",null," 格式建议：透明背景图片，PNG或gif,logo图形使用深色")],-1),S={key:0,class:"dialog-footer"},U={emits:["dialogClose","dialogSuccess"]};var h=Object.assign(U,{__name:"companyFormDialog",props:{dialogObject:Object},setup(e,{emit:a}){const l=e,i=(0,t.Fl)((()=>l.dialogObject.company));let s=(0,o.qj)({form:{}});const u=(0,o.iH)(""),r=(0,o.iH)({phoneNum:[{required:!0,message:"请输入联系人手机号码",trigger:"blur"},{pattern:/^1[3456789]\d{9}$/,message:"手机号码格式不正确",trigger:"blur"}],orgzName:[{required:!0,message:"请输入企业名称",trigger:"blur"}],userName:[{required:!0,message:"请输入企业联系人",trigger:"blur"}]}),d=(0,t.Fl)({get(){return l.dialogObject.dialogVisible},set(e){return e}}),c=(0,t.Fl)((()=>({dialogTitle:l.dialogObject.title||"企业信息",dialogWidth:l.dialogObject.width||"780px",dialogCloseBtnText:l.dialogObject.closeBtnText||"取消",dialogSuccessBtnText:l.dialogObject.successBtnText||"确定",dialogIsFooter:l.dialogObject.isFooter||!0})));(0,t.YP)(i,(e=>{s.form=e.add?{}:e}),{deep:!0,immediate:!0});const g=()=>{a("dialogClose"),u.value.resetFields()},p=e=>{e&&e.validate(((e,l)=>{e?a("dialogSuccess",s.form):console.log("error submit!",l)}))};return(e,a)=>{const l=(0,t.up)("el-input"),i=(0,t.up)("el-form-item"),m=(0,t.up)("UploadImage"),b=(0,t.up)("el-form"),f=(0,t.up)("el-button"),U=(0,t.up)("el-dialog");return(0,t.wg)(),(0,t.iD)("div",null,[(0,t.Wm)(U,{modelValue:(0,o.SU)(d),"onUpdate:modelValue":a[4]||(a[4]=e=>(0,o.dq)(d)?d.value=e:null),title:(0,o.SU)(c).dialogTitle,width:(0,o.SU)(c).dialogWidth,"before-close":g,draggable:""},{footer:(0,t.w5)((()=>[(0,o.SU)(c).dialogIsFooter?((0,t.wg)(),(0,t.iD)("span",S,[(0,t.Wm)(f,{onClick:g},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)((0,o.SU)(c).dialogCloseBtnText),1)])),_:1}),(0,t.Wm)(f,{type:"primary",onClick:a[3]||(a[3]=e=>p(u.value))},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)((0,o.SU)(c).dialogSuccessBtnText),1)])),_:1})])):(0,t.kq)("",!0)])),default:(0,t.w5)((()=>[(0,t.Wm)(b,{class:"m-form-content",ref_key:"formRef",ref:u,model:(0,o.SU)(s).form,rules:r.value,"label-width":"120px"},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{label:"企业名称",prop:"orgzName"},{default:(0,t.w5)((()=>[(0,t.Wm)(l,{modelValue:(0,o.SU)(s).form.orgzName,"onUpdate:modelValue":a[0]||(a[0]=e=>(0,o.SU)(s).form.orgzName=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(i,{label:"企业/组织Logo"},{default:(0,t.w5)((()=>[(0,t._)("div",w,[(0,t.Wm)(m,{class:"m-uploader"}),_])])),_:1}),(0,t.Wm)(i,{label:"联系人",prop:"userName"},{default:(0,t.w5)((()=>[(0,t.Wm)(l,{modelValue:(0,o.SU)(s).form.userName,"onUpdate:modelValue":a[1]||(a[1]=e=>(0,o.SU)(s).form.userName=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(i,{label:"手机号码",prop:"phoneNum"},{default:(0,t.w5)((()=>[(0,t.Wm)(l,{modelValue:(0,o.SU)(s).form.phoneNum,"onUpdate:modelValue":a[2]||(a[2]=e=>(0,o.SU)(s).form.phoneNum=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title","width"])])}}});const k=h;var y=k,v=l(2941),z=l(9996);const j={class:"v-company v-page"},W={class:"m-search-box"},N=(0,t.Uk)("企业开户"),C={class:"m-tips-content"},V=(0,t._)("span",{class:"u-title"},"是否启用/停用企业账户",-1);var q={__name:"CompanyList",setup(e){const a=(0,i.t)(),{label:l,role:u}=(0,s.Jk)(a),r={placeholder:"请输入企业ID/企业名称/联系人/联系电话",status_title:"-- 企业账户状态 --",status:[{label:"全部",value:-1},{label:"正常",value:0},{label:"已停用",value:1}]};let d=(0,o.qj)({loading:!1,table:[],pagination:{page:1,per:20,total:0},search:{input:null,status:null},form:{}});const c=(0,t.Fl)((()=>({pageIndex:d.pagination.page-1,pageSize:d.pagination.per,Condition:d.search.input,Status:d.search.status}))),g={organizationId:"",orgzLogo:"",orgzName:"",phoneNum:"",userId:"",userName:""};let p=(0,o.iH)("form"),m=(0,o.qj)({dialogVisible:!1,company:g});const b=(0,t.Fl)((()=>u.value.includes(9)));function w({input_txt:e,status_id:a}){d.search.input=e,d.search.status=-1==a?null:a,d.pagination.page=1,q()}function _(e){d.pagination.page=e,q()}function S({row:e,type:a}){m.dialogVisible=!0;const l=e||g;"add"==a&&(l.add=!0),m.company=l,p.value="close"==a?"tips":"form"}const U=()=>{m.dialogVisible=!1},h=()=>{const{organizationId:e,status:a}=m.company,l="正常"==a?1:0,t=0==l?"启用":"停用";(0,v.mz)(e,l).then((()=>{m.dialogVisible=!1,q(),(0,z.bM)({title:"成功",message:`${t}企业成功`,type:"success"})}))},k=e=>{m.dialogVisible=!1,e.logo=e.orgzLogo,e.organizationId?(0,v.ji)(e).then((()=>{(0,z.bM)({title:"成功",message:"修改企业信息成功",type:"success"})})):(0,v.lQ)(e).then((()=>{(0,z.bM)({title:"成功",message:"添加企业成功",type:"success"})}))};function q(){d.loading=!0,(0,v.m_)(c.value).then((e=>{if("200"==e.status){const a=e.data.data;d.table=a.datas,d.pagination.total=a.totalCount}})).finally((()=>d.loading=!1))}return(0,t.bv)((()=>q())),(e,a)=>{const i=(0,t.up)("search-bar"),s=(0,t.up)("el-button"),u=(0,t.up)("commonPagination"),c=(0,t.up)("tipsDialog"),g=(0,t.Q2)("loading");return(0,t.wg)(),(0,t.iD)("div",j,[(0,t._)("div",W,[(0,t.Wm)(i,{data:r,onToSearch:w}),(0,o.SU)(b)?((0,t.wg)(),(0,t.j4)(s,{key:0,class:"u-add",type:"primary",onClick:a[0]||(a[0]=e=>S({type:"add"}))},{default:(0,t.w5)((()=>[N])),_:1})):(0,t.kq)("",!0)]),(0,t.wy)((0,t.Wm)((0,o.SU)(f),{table:(0,o.SU)(d).table,label:(0,o.SU)(l),onToDialog:S},null,8,["table","label"]),[[g,(0,o.SU)(d).loading]]),(0,t.Wm)(u,{pagination:(0,o.SU)(d).pagination,onToParams:_},null,8,["pagination"]),"tips"==(0,o.SU)(p)?((0,t.wg)(),(0,t.j4)(c,{key:0,class:"m-tips","dialog-object":(0,o.SU)(m),onDialogClose:U,onDialogSuccess:h},{default:(0,t.w5)((()=>[(0,t._)("div",C,[V,(0,t._)("span",null,(0,n.zw)((0,o.SU)(m).company.orgzName),1),(0,t._)("span",null,"企业ID: "+(0,n.zw)((0,o.SU)(m).company.organizationId),1)])])),_:1},8,["dialog-object"])):(0,t.kq)("",!0),"form"==(0,o.SU)(p)?((0,t.wg)(),(0,t.j4)((0,o.SU)(y),{key:1,class:"m-form","dialog-object":(0,o.SU)(m),onDialogClose:U,onDialogSuccess:k},null,8,["dialog-object"])):(0,t.kq)("",!0)])}}};const I=q;var O=I}}]);
//# sourceMappingURL=578.d9ecde2a.js.map