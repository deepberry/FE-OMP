"use strict";(self["webpackChunkomp"]=self["webpackChunkomp"]||[]).push([[171],{3727:function(e,t,l){l.d(t,{Ol:function(){return n},ag:function(){return i},eM:function(){return o},qM:function(){return d}});var a=l(6146);function o(e){return(0,a.u)().get("/api/Device",{params:e})}function i(e){return(0,a.u)().post("/api/Device",e)}function n(e){return(0,a.u)().put("/api/Device",e)}function d(e){return(0,a.u)().get(`/api/Device/${e}`)}},5171:function(e,t,l){l.r(t),l.d(t,{default:function(){return D}});var a=l(6252),o=l(2262),i=l(4239);const n={class:"u-table-button"},d=(0,a.Uk)("编辑"),u=(0,a.Uk)("查看详情 ");var r={__name:"equipmentTable",props:{table:Array,label:String},emits:["toDialog"],setup(e,{emit:t}){const l=e;let i=(0,o.qj)({data:[]});function r(e,l){t("toDialog",{row:e,type:l})}return(0,a.YP)(l,(e=>{i.data=e.table}),{deep:!0}),(t,l)=>{const s=(0,a.up)("el-table-column"),c=(0,a.up)("el-button"),p=(0,a.up)("router-link"),m=(0,a.up)("el-table");return(0,a.wg)(),(0,a.j4)(m,{class:"m-table",data:(0,o.SU)(i).data,border:"",style:{width:"100%"}},{default:(0,a.w5)((()=>[(0,a.Wm)(s,{prop:"deviceId",label:"设备ID"}),(0,a.Wm)(s,{prop:"deviceName",label:"硬件名称"}),(0,a.Wm)(s,{prop:"orgzName",label:"归属企业"}),(0,a.Wm)(s,{prop:"hard_version",label:"硬件版本"}),(0,a.Wm)(s,{prop:"soft_version",label:"固件版本"}),(0,a.Wm)(s,{prop:"iccid",label:"ICCID"}),(0,a.Wm)(s,{prop:"address",label:"操作",width:"180"},{default:(0,a.w5)((t=>[(0,a._)("div",n,[(0,a.Wm)(c,{link:"",type:"primary",size:"small",onClick:e=>r(t.row)},{default:(0,a.w5)((()=>[d])),_:2},1032,["onClick"]),(0,a.Wm)(p,{to:{path:`/${e.label}/details/${t.row.deviceId}`},class:"u-table-more"},{default:(0,a.w5)((()=>[u])),_:2},1032,["to"])])])),_:1})])),_:1},8,["data"])}}},s=l(3744);const c=(0,s.Z)(r,[["__scopeId","data-v-703c2cd3"]]);var p=c,m=l(3577);const g={key:0,class:"dialog-footer"},b={emits:["dialogClose","dialogSuccess"]};var f=Object.assign(b,{__name:"equipmentFormDialog",props:{dialogObject:Object},setup(e,{emit:t}){const l=e,i=(0,a.Fl)({get(){return l.dialogObject.dialogVisible},set(e){return e}}),n={dialogTitle:l.dialogObject.title||"设备信息",dialogWidth:l.dialogObject.width||"760px",dialogCloseBtnText:l.dialogObject.closeBtnText||"取消",dialogSuccessBtnText:l.dialogObject.successBtnText||"成功",dialogIsFooter:l.dialogObject.isFooter||!0,dialogContent:l.dialogObject.content||"是否停用"},d=(0,a.Fl)((()=>l.dialogObject.equipment));let u=(0,o.qj)({form:{}});const r=(0,o.iH)(""),s=(0,o.iH)({orgzId:[{required:!0,message:"请选择企业",trigger:"blur"}],deviceName:[{required:!0,message:"请输入设备名称",trigger:"blur"}],deviceId:[{required:!0,message:"请输入设备ID",trigger:"blur"}]});(0,a.YP)(d,(e=>u.form=e),{deep:!0,immediate:!0});const c=e=>{t("dialogClose"),e.resetFields()},p=e=>{e&&e.validate(((e,l)=>{e?t("dialogSuccess",u.form):console.log("error submit!",l)}))};return(e,t)=>{const l=(0,a.up)("el-input"),d=(0,a.up)("el-form-item"),b=(0,a.up)("el-form"),f=(0,a.up)("el-button"),v=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(v,{modelValue:(0,o.SU)(i),"onUpdate:modelValue":t[5]||(t[5]=e=>(0,o.dq)(i)?i.value=e:null),title:n.dialogTitle,width:n.dialogWidth,"before-close":c,draggable:""},{footer:(0,a.w5)((()=>[n.dialogIsFooter?((0,a.wg)(),(0,a.iD)("span",g,[(0,a.Wm)(f,{onClick:t[3]||(t[3]=e=>c(r.value))},{default:(0,a.w5)((()=>[(0,a.Uk)((0,m.zw)(n.dialogCloseBtnText),1)])),_:1}),(0,a.Wm)(f,{type:"primary",onClick:t[4]||(t[4]=e=>p(r.value))},{default:(0,a.w5)((()=>[(0,a.Uk)((0,m.zw)(n.dialogSuccessBtnText),1)])),_:1})])):(0,a.kq)("",!0)])),default:(0,a.w5)((()=>[(0,a.Wm)(b,{class:"m-form-content",ref_key:"formRef",ref:r,model:(0,o.SU)(u).form,rules:s.value,"label-width":"120px"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{label:"设备ID",prop:"deviceId"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{modelValue:(0,o.SU)(u).form.deviceId,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,o.SU)(u).form.deviceId=e)},null,8,["modelValue"])])),_:1}),(0,a.Wm)(d,{label:"硬件名称",prop:"deviceName"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{modelValue:(0,o.SU)(u).form.deviceName,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,o.SU)(u).form.deviceName=e)},null,8,["modelValue"])])),_:1}),(0,a.Wm)(d,{label:"归属客户",prop:"orgzId"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{modelValue:(0,o.SU)(u).form.orgzId,"onUpdate:modelValue":t[2]||(t[2]=e=>(0,o.SU)(u).form.orgzId=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title","width"])])}}});const v=f;var w=v,_=l(3727),W=l(9996);const U={class:"v-equipment v-page"},S={class:"m-search-box"},h=(0,a.Uk)("添加设备");var I={__name:"EquipmentList",setup(e){const t=(0,i.t)(),{label:l}=t,n={uid:"",placeholder:"请输入设备ID/硬件名称/ICCID/归属客户",bind_title:"-- 绑定状态 --",bind:[{label:"已绑定",value:1},{label:"未绑定",value:0}],connect_title:"-- 连接状态 --",connect:[{label:"在线",value:1},{label:"离线",value:0}]};let d=(0,o.qj)({loading:!1,table:[],pagination:{page:1,per:20,total:0},search:{input:null,status:null},form:{}});const u=(0,a.Fl)((()=>({pageIndex:d.pagination.page-1,pageSize:d.pagination.per}))),r={};let s=(0,o.qj)({dialogVisible:!1,equipment:r});function c({input_txt:e,status_id:t}){d.search.input=e,d.search.status=-1==t?null:t,d.pagination.page=1,v()}function m(e){d.pagination.page=e,v()}const g=()=>{s.dialogVisible=!1};function b({row:e,type:t}){s.dialogVisible=!0;const l=e||r;"add"==t&&(l.add=!0),s.equipment=l}const f=e=>{s.dialogVisible=!1,e.add?(0,_.ag)(e).then((()=>{(0,W.bM)({title:"成功",message:"添加设备成功",type:"success"})})):(0,_.Ol)(e).then((()=>{(0,W.bM)({title:"成功",message:"修改设备信息成功",type:"success"})}))};function v(){d.loading=!0,(0,_.eM)(u.value).then((e=>{if("200"==e.status){const t=e.data.data;d.table=t.datas,d.pagination.total=t.totalCount}})).finally((()=>d.loading=!1))}return(0,a.bv)((()=>v())),(e,t)=>{const i=(0,a.up)("search-bar"),u=(0,a.up)("el-button"),r=(0,a.up)("commonPagination"),v=(0,a.Q2)("loading");return(0,a.wg)(),(0,a.iD)("div",U,[(0,a._)("div",S,[(0,a.Wm)(i,{data:n,onToSearch:c}),(0,a.Wm)(u,{class:"u-add",type:"primary",onClick:t[0]||(t[0]=e=>b({type:"add"}))},{default:(0,a.w5)((()=>[h])),_:1})]),(0,a.wy)((0,a.Wm)((0,o.SU)(p),{table:(0,o.SU)(d).table,label:(0,o.SU)(l),onToDialog:b},null,8,["table","label"]),[[v,(0,o.SU)(d).loading]]),(0,a.Wm)(r,{pagination:(0,o.SU)(d).pagination,onToParams:m},null,8,["pagination"]),(0,a.Wm)((0,o.SU)(w),{class:"m-form","dialog-object":(0,o.SU)(s),onDialogClose:g,onDialogSuccess:f},null,8,["dialog-object"])])}}};const k=I;var D=k}}]);
//# sourceMappingURL=171.f60610d7.js.map