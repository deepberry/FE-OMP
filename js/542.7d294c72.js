"use strict";(self["webpackChunkomp"]=self["webpackChunkomp"]||[]).push([[542],{1542:function(e,t,a){a.r(t),a.d(t,{default:function(){return y}});var n=a(6252),s=a(2262),c=a(2201),o=a(2908),r=a(6146);function i(e){return(0,r.u)().get(`/api/Work/login?code=${e}`)}function l(e){return(0,r.u)().get(`/api/Manage/uer/${e}/role`)}var u=a(1575),d=a(8825);const p=e=>((0,n.dD)("data-v-4c780cdc"),e=e(),(0,n.Cn)(),e),m={class:"v-home"},h=["src"],f=p((()=>(0,n._)("span",{class:"title"},"深莓智能运营管理平台",-1))),g={key:0,class:"desc"},k=(0,n.Uk)("连接失败，请再次尝试，或联系管理人员");var v={__name:"HomeView",setup(e){const t=(0,c.yj)(),a=(0,c.tv)(),r=(0,d.t)();let{role:p}=(0,u.Jk)(r);const v="ww5429d07e97752284",_=encodeURI("https://admin.deepberry.cn/omp/"),w=`https://open.weixin.qq.com/connect/oauth2/authorize?appid=${v}&redirect_uri=${_}&response_type=code&scope=snsapi_base&state=STATE#wechat_redirect`,y=(0,s.qj)({fail:!1});return(0,n.YP)(t,(e=>{e.query.code&&i(e.query.code).then((e=>{y.fail=!1,localStorage.setItem("token",JSON.stringify(e.data.accessToken)),l(e.data.userId).then((e=>{p=e.data.viewPermissoins,r.role=p,p.value.length?a.push({name:"company"}):a.push({name:"details",params:{type:"role",id:0}})}))})).catch((e=>{console.log(e),y.fail=!0}))}),{deep:!0,immediate:!0}),(e,t)=>{const a=(0,n.up)("Warning");return(0,n.wg)(),(0,n.iD)("div",m,[(0,n._)("img",{class:"logo",src:(0,s.SU)(o),alt:"深莓智能"},null,8,h),f,(0,n._)("a",{href:w,class:"button"},"点击进入"),y.fail?((0,n.wg)(),(0,n.iD)("span",g,[(0,n.Wm)(a,{class:"icon"}),k])):(0,n.kq)("",!0)])}}},_=a(3744);const w=(0,_.Z)(v,[["__scopeId","data-v-4c780cdc"]]);var y=w}}]);
//# sourceMappingURL=542.7d294c72.js.map