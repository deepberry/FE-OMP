"use strict";(self["webpackChunkomp"]=self["webpackChunkomp"]||[]).push([[30],{9030:function(e,a,t){t.r(a),t.d(a,{default:function(){return y}});var s=t(6252),n=t(2262),o=t(2201),c=t(2908),r=t(6146);function i(){return(0,r.u)().get("/api/Work/userInfo")}function l(e){return(0,r.u)().get(`/api/Manage/uer/${e}/role`)}var u=t(1575),p=t(8825);const d=e=>((0,s.dD)("data-v-150e5eab"),e=e(),(0,s.Cn)(),e),m={class:"v-home"},h=["src"],g=d((()=>(0,s._)("span",{class:"title"},"深莓智能运营管理平台",-1))),f={key:0,class:"desc"},v=(0,s.Uk)("连接失败，请再次尝试，或联系管理人员");var k={__name:"HomeView",setup(e){const a=(0,o.yj)(),t=(0,o.tv)(),r=(0,p.t)();let{role:d}=(0,u.Jk)(r);console.log(d);const k="ww5429d07e97752284",_=encodeURI("https://admin.deepberry.cn/omp/"),w=`https://open.weixin.qq.com/connect/oauth2/authorize?appid=${k}&redirect_uri=${_}&response_type=code&scope=snsapi_base&state=STATE#wechat_redirect`,y=(0,n.iH)(""),b=(0,n.qj)({fail:!1});return(0,s.YP)(a,(e=>{y.value=e.query.code}),{deep:!0,immediate:!0}),(0,s.YP)(y,(e=>{console.log(e),e&&i({code:e}).then((e=>{b.fail=!1,localStorage.setItem("token",JSON.stringify(e.data.accessToken)),l(e.data.userId).then((e=>{d=e.data.viewPermissoins,r.role=d,console.log(d),d.value.length?t.push({name:"company"}):t.push({name:"details",params:{type:"role",id:0}})}))})).catch((e=>{console.log(e),b.fail=!0}))}),{deep:!0,immediate:!0}),(e,a)=>{const t=(0,s.up)("Warning");return(0,s.wg)(),(0,s.iD)("div",m,[(0,s._)("img",{class:"logo",src:(0,n.SU)(c),alt:"深莓智能"},null,8,h),g,(0,s._)("a",{href:w,class:"button"},"点击进入"),b.fail?((0,s.wg)(),(0,s.iD)("span",f,[(0,s.Wm)(t,{class:"icon"}),v])):(0,s.kq)("",!0)])}}},_=t(3744);const w=(0,_.Z)(k,[["__scopeId","data-v-150e5eab"]]);var y=w}}]);
//# sourceMappingURL=30.af030b25.js.map