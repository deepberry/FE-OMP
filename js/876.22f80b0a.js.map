{"version":3,"file":"js/876.22f80b0a.js","mappings":"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","sources":["webpack://omp/./src/service/customer.js","webpack://omp/./src/components/table/customerTable.vue","webpack://omp/./src/components/table/customerTable.vue?a203","webpack://omp/./src/views/CustomerList.vue","webpack://omp/./src/views/CustomerList.vue?9d26"],"sourcesContent":["import { $admin } from \"./axios.js\";\n\n// 获取用户列表\nfunction getCustomerList(params) {\n    return $admin().get(`/api/User`, { params });\n}\n\n// 用户停用/启用\nfunction enabledCustomer(UserId, enabled) {\n    return $admin().put(`/api/User/${UserId}/enabled/${enabled}`);\n}\n// 用户详情\nfunction getCustomerInfo(UserId) {\n    return $admin().get(`/api/User/${UserId}`);\n}\nexport { getCustomerList, enabledCustomer, getCustomerInfo };\n","<template>\n    <el-table class=\"m-table\" :data=\"state.data\" border fit style=\"width: 100%\">\n        <el-table-column prop=\"userId\" label=\"用户ID\" width=\"120\" />\n        <el-table-column prop=\"userName\" label=\"用户名\" width=\"180\" />\n        <el-table-column prop=\"phoneNum\" label=\"手机号码\" width=\"180\" />\n        <el-table-column prop=\"orgzName\" label=\"所在企业\" />\n        <el-table-column prop=\"status\" label=\"帐号状态\" width=\"120\">\n            <template #default=\"scope\">\n                <span :class=\"scope.row.status === '禁用' ? 'u-table-disabled' : 'u-table-normal'\">\n                    {{ scope.row.status }}</span\n                >\n            </template>\n        </el-table-column>\n        <el-table-column prop=\"updateAt\" label=\"最近登录\" width=\"240\" />\n        <el-table-column prop=\"address\" label=\"操作\" width=\"180\" v-if=\"hasOperate\">\n            <template #default=\"scope\">\n                <div class=\"u-table-button\">\n                    <el-button link type=\"primary\" size=\"small\" @click=\"handelClick(scope.row)\" v-if=\"hasEnabled\">{{\n                        scope.row.status == \"正常\" ? \"停用\" : \"启用\"\n                    }}</el-button>\n                    <router-link\n                        :to=\"{ path: `/${label}/details/${scope.row.userId}` }\"\n                        class=\"u-table-more\"\n                        v-if=\"hasInfo\"\n                        >查看详情\n                    </router-link>\n                </div>\n            </template>\n        </el-table-column>\n    </el-table>\n</template>\n<script setup>\nimport { defineProps, defineEmits, watch, reactive, computed } from \"vue\";\nimport { deepBerryStore } from \"@/store/index\";\nimport { storeToRefs } from \"pinia\";\n\n//====== 数据 ======\n// props\nconst props = defineProps({\n    table: Array,\n    label: String,\n});\nconst emit = defineEmits([\"toDialog\"]);\n\n// store\nconst store = deepBerryStore();\nconst { role } = storeToRefs(store);\n\n// 表格data数据\nlet state = reactive({\n    data: [],\n});\n\n// 权限判断\n// 查看详情权限\nconst hasInfo = computed(() => role.value.includes(17));\n// 启用停用权限\nconst hasEnabled = computed(() => role.value.includes(15));\n// 操作权限\nconst arr = [17, 15];\nconst hasOperate = computed(() => role.value.map((item) => arr.includes(item)).filter(Boolean).length);\n\n// 监控表格数据\nwatch(\n    props,\n    (obj) => {\n        state.data = obj.table;\n    },\n    { deep: true }\n);\n\n//====== 交互 ======\n// 提交企业id和弹窗类型\nfunction handelClick(row, type) {\n    emit(\"toDialog\", { row, type });\n}\n</script>\n<style lang=\"less\" scoped>\n@import \"@/assets/css/components/table.less\";\n</style>\n","import script from \"./customerTable.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./customerTable.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./customerTable.vue?vue&type=style&index=0&id=30d92239&lang=less&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/omp/omp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-30d92239\"]])\n\nexport default __exports__","<!--\n * @Author: iRuxu\n * @Date: 2022-06-20 18:07:51\n * @LastEditTime: 2022-06-20 18:59:41\n * @Description:客户管理\n-->\n<template>\n    <div class=\"v-customer v-page\">\n        <!-- 搜索 -->\n        <div class=\"m-search-box\">\n            <search-bar :data=\"customer_data\" @toSearch=\"onToSearch\" />\n        </div>\n        <!-- 表单 -->\n        <customerTable :table=\"state.table\" :label=\"label\" @toDialog=\"onToDialog\" v-loading=\"state.loading\" />\n        <!-- 分页 -->\n        <commonPagination :pagination=\"state.pagination\" @toParams=\"onToParams\" />\n        <!-- 提示弹窗 -->\n        <tipsDialog\n            class=\"m-tips\"\n            :dialog-object=\"dialogObject\"\n            @dialogClose=\"onDialogClose\"\n            @dialogSuccess=\"onTipsSuccess\"\n        >\n            <div class=\"m-tips-content\">\n                <span class=\"u-title\">是否启用/停用用户帐号</span>\n                <span class=\"u-label\">{{ dialogObject.customer.orgzName }}</span>\n                <span class=\"u-value\">({{ dialogObject.customer.phoneNum }})</span>\n            </div>\n        </tipsDialog>\n    </div>\n</template>\n\n<script setup>\nimport { reactive, onMounted, computed, ref } from \"vue\";\nimport { deepBerryStore } from \"@/store/index\";\nimport customerTable from \"@/components/table/customerTable\";\nimport { getCustomerList, enabledCustomer } from \"@/service/customer\";\nimport { ElNotification } from \"element-plus\";\nimport { storeToRefs } from \"pinia\";\n\n//====== 数据 ======\n\n// 获取公共数据\nconst store = deepBerryStore();\nconst { label } = storeToRefs(store);\n\n// 搜索 默认选项数据\nconst customer_data = {\n    uid: \"\",\n    placeholder: `请输入用户ID/用户姓名/手机号码/所在成员名称`,\n    status_title: \"-- 用户帐号状态 --\",\n    status: [\n        {\n            label: \"正常\",\n            value: 0,\n        },\n        {\n            label: \"已停用\",\n            value: 1,\n        },\n    ],\n};\n\n// 表格 翻页 成员id 成员名称 弹窗表格\nlet state = reactive({\n    loading: false,\n    table: [],\n    pagination: {\n        page: 1,\n        per: 20,\n        total: 0,\n    },\n    search: {\n        input: null,\n        status: null,\n    },\n    form: {},\n});\n\n// axios查询数据\nconst params = computed(() => {\n    return {\n        pageIndex: state.pagination.page - 1,\n        pageSize: state.pagination.per,\n        Condition: state.search.input,\n        Status: state.search.status,\n    };\n});\n\n// 默认表单\nconst customer = {};\n\n// 弹窗\nlet dialogType = ref(\"form\");\nlet dialogObject = reactive({\n    dialogVisible: false,\n    customer: customer,\n});\n\n//====== 交互 ======\n\n// 搜索查询\nfunction onToSearch({ input_txt, status_id }) {\n    state.search.input = input_txt;\n    state.search.status = status_id == -1 ? null : status_id;\n    state.pagination.page = 1;\n    loadCustomerList();\n}\n\n// 翻页页码并搜索新的列表\nfunction onToParams(e) {\n    state.pagination.page = e;\n    loadCustomerList();\n}\n\n// 打开弹窗\nfunction onToDialog({ row, type }) {\n    dialogObject.dialogVisible = true;\n    dialogObject.customer = row ? row : customer;\n    dialogType.value = type == \"close\" ? \"tips\" : \"form\";\n}\n\n// 关闭弹窗\nconst onDialogClose = () => {\n    dialogObject.dialogVisible = false;\n};\n// 确定 tips弹窗 - 成员停用或启用\nconst onTipsSuccess = () => {\n    const { userId, status } = dialogObject.customer;\n    const enabled = status == \"正常\" ? 1 : 0;\n    const msg = enabled == 1 ? \"启用\" : \"停用\";\n    enabledCustomer(userId, enabled).then(() => {\n        dialogObject.dialogVisible = false;\n        loadCustomerList();\n        ElNotification({\n            title: \"成功\",\n            message: `${msg}成员成功`,\n            type: \"success\",\n        });\n    });\n};\n\n//====== axios数据 ======\n\n// 初始加载\nonMounted(() => loadCustomerList());\n\n// 获取成员列表\nfunction loadCustomerList() {\n    state.loading = true;\n    getCustomerList(params.value)\n        .then((res) => {\n            if (res.status == \"200\") {\n                const data = res.data.data;\n                state.table = data.datas;\n                state.pagination.total = data.totalCount;\n            }\n        })\n        .finally(() => (state.loading = false));\n}\n</script>\n","import script from \"./CustomerList.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./CustomerList.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["getCustomerList","params","$admin","get","enabledCustomer","UserId","enabled","put","getCustomerInfo","store","deepBerryStore","role","storeToRefs","state","reactive","data","hasInfo","computed","value","includes","hasEnabled","arr","hasOperate","map","item","filter","Boolean","length","handelClick","row","type","emit","watch","props","obj","table","deep","__exports__","label","customer_data","uid","placeholder","status_title","status","loading","pagination","page","per","total","search","input","form","pageIndex","pageSize","Condition","Status","customer","dialogType","ref","dialogObject","dialogVisible","onToSearch","input_txt","status_id","loadCustomerList","onToParams","e","onToDialog","onDialogClose","onTipsSuccess","userId","msg","then","ElNotification","title","message","res","datas","totalCount","finally","onMounted"],"sourceRoot":""}