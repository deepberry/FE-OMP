{"version":3,"file":"js/192.2eb7070e.js","mappings":"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","sources":["webpack://omp/./src/service/manage.js","webpack://omp/./src/components/table/memberTable.vue","webpack://omp/./src/components/table/memberTable.vue?96fe","webpack://omp/./src/components/dialog/userRoleFormDialog.vue","webpack://omp/./src/components/dialog/userRoleFormDialog.vue?1693","webpack://omp/./src/service/member.js","webpack://omp/./src/views/MemberList.vue","webpack://omp/./src/views/MemberList.vue?e7d1"],"sourcesContent":["import { $admin } from \"./axios.js\";\n\n// 添加角色\nfunction addRole(data) {\n    return $admin().post(`/api/Manage/role`, data);\n}\n\n// 更新角色\nfunction editRole(data) {\n    return $admin().put(`/api/Manage/role`, data);\n}\n\n// 删除角色\nfunction delRole(id) {\n    return $admin().delete(`/api/Manage/role/${id}`);\n}\n\n// 获取所有角色\nfunction getRoles() {\n    return $admin().get(`/api/Manage/role`);\n}\n\n// 获取指定角色\nfunction getRoleId(id) {\n    return $admin().get(`/api/Manage/role/${id}`);\n}\n\n// 设置角色权限\nfunction setRolePermission({ id, prmIds }) {\n    return $admin().post(`/api/Manage/role/${id}/permission`, { prmIds });\n}\n\n// 获取所有权限\nfunction getRolePermission() {\n    return $admin().get(`/api/Manage/permission`);\n}\n\n// 获取指定权限\nfunction getRolePermissionId(id) {\n    return $admin().get(`/api/Manage/permission/${id}`);\n}\n\nexport { addRole, editRole, delRole, getRoles, getRoleId, setRolePermission, getRolePermission, getRolePermissionId };\n","<template>\n    <el-table class=\"m-table\" :data=\"table\" border fit style=\"width: 100%\">\n        <el-table-column prop=\"userId\" label=\"userId\" />\n        <el-table-column prop=\"name\" label=\"姓名\" width=\"180\" />\n        <el-table-column prop=\"mobile\" label=\"手机号码\" width=\"180\" />\n        <el-table-column prop=\"address\" label=\"部门\" />\n        <el-table-column prop=\"roleNames\" label=\"角色\" />\n        <el-table-column prop=\"disabled\" label=\"状态\" width=\"120\">\n            <template #default=\"scope\">\n                <span :class=\"scope.row.disabled === '正常' ? 'u-table-normal' : 'u-table-disabled'\">\n                    {{ scope.row.disabled }}</span\n                >\n            </template>\n        </el-table-column>\n        <el-table-column label=\"操作\" v-if=\"hasOperate\" width=\"180\">\n            <template #default=\"scope\">\n                <div class=\"u-table-button\">\n                    <el-button\n                        link\n                        type=\"primary\"\n                        size=\"small\"\n                        @click=\"handelClick(scope.row, 'close')\"\n                        v-if=\"hasEnabled\"\n                        >停用</el-button\n                    >\n                    <el-button link type=\"primary\" size=\"small\" @click=\"handelClick(scope.row, 'role')\" v-if=\"hasEdit\"\n                        >授权角色权限\n                    </el-button>\n                </div>\n            </template>\n        </el-table-column>\n    </el-table>\n</template>\n<script setup>\nimport { defineProps, defineEmits, watch, reactive, computed } from \"vue\";\nimport { deepBerryStore } from \"@/store/index\";\nimport { storeToRefs } from \"pinia\";\n\n//====== 数据 ======\n// props\nconst props = defineProps({\n    table: Array,\n});\nconst emit = defineEmits([\"toDialog\"]);\n\n// store\nconst store = deepBerryStore();\nconst { role } = storeToRefs(store);\n\n// 权限判断\n// 编辑权限\nconst hasEdit = computed(() => role.value.includes(31));\n// 启用停用权限\nconst hasEnabled = computed(() => role.value.includes(30));\n// 操作权限\nconst arr = [30, 31];\nconst hasOperate = computed(() => role.value.map((item) => arr.includes(item)).filter(Boolean).length);\n\n// 表格data数据\nlet state = reactive({\n    data: [],\n});\n// 监控表格数据\nwatch(\n    props,\n    (obj) => {\n        state.data = obj.table;\n    },\n    { deep: true }\n);\n//====== 交互 ======\n// 提交企业id和弹窗类型\nfunction handelClick(row, type) {\n    emit(\"toDialog\", { row, type });\n}\n</script>\n<style lang=\"less\" scoped>\n@import \"@/assets/css/components/table.less\";\n</style>\n","import script from \"./memberTable.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./memberTable.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./memberTable.vue?vue&type=style&index=0&id=1fc07d9c&lang=less&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/omp/omp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-1fc07d9c\"]])\n\nexport default __exports__","<template>\n    <div>\n        <el-dialog\n            v-model=\"dialogShow\"\n            :title=\"obj.dialogTitle\"\n            :width=\"obj.dialogWidth\"\n            :before-close=\"close\"\n            draggable\n        >\n            <el-form class=\"m-form-content\" :model=\"obj.dialogForm\" label-width=\"120px\">\n                <el-form-item label=\"姓名\">\n                    {{ obj.dialogForm.name || \"-\" }}\n                </el-form-item>\n                <el-form-item label=\"手机号码\">\n                    {{ obj.dialogForm.mobile || \"-\" }}\n                </el-form-item>\n                <el-form-item label=\"授权角色\">\n                    <el-select v-model=\"obj.dialogForm.roleIds\" multiple placeholder=\"请选择角色\">\n                        <el-option v-for=\"(item, i) in roles\" :key=\"i\" :label=\"item.name\" :value=\"item.roleId\" />\n                    </el-select>\n                </el-form-item>\n            </el-form>\n            <template #footer>\n                <span v-if=\"obj.dialogIsFooter\" class=\"dialog-footer\">\n                    <el-button @click=\"close\">{{ obj.dialogCloseBtnText }}</el-button>\n                    <el-button type=\"primary\" @click=\"success\">{{ obj.dialogSuccessBtnText }}</el-button>\n                </span>\n            </template>\n        </el-dialog>\n    </div>\n</template>\n<script setup>\nimport { defineProps, defineEmits, computed } from \"vue\";\n//====== 数据 ======\n\n// props\nconst props = defineProps({\n    dialogObject: Object,\n});\nconst emit = defineEmits();\n\n// 弹窗显示\nconst dialogShow = computed({\n    get() {\n        return props.dialogObject.dialogVisible;\n    },\n    set(val) {\n        return val;\n    },\n});\n\n// 显示数据\nconst roles = computed(() => props.dialogObject.role);\n\nconst obj = computed(() => {\n    return {\n        dialogTitle: props.dialogObject.title || \"角色权限\",\n        dialogWidth: props.dialogObject.width || \"760px\",\n        dialogCloseBtnText: props.dialogObject.closeBtnText || \"取消\",\n        dialogSuccessBtnText: props.dialogObject.successBtnText || \"成功\",\n        dialogIsFooter: props.dialogObject.isFooter || true,\n        dialogContent: props.dialogObject.content || \"是否停用\",\n        dialogForm: props.dialogObject.member || {},\n    };\n});\n\n//====== 互动 ======\n// 取消关闭\nconst close = () => {\n    emit(\"dialogClose\");\n};\n// 成功\nconst success = () => {\n    emit(\"dialogSuccess\", obj.value.dialogForm);\n};\n</script>\n<script>\nexport default {\n    emits: [\"dialogClose\", \"dialogSuccess\"],\n};\n</script>\n<style lang=\"less\">\n@import \"@/assets/css/components/dialog.less\";\n</style>\n","import script from \"./userRoleFormDialog.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./userRoleFormDialog.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./userRoleFormDialog.vue?vue&type=style&index=0&id=d13d2924&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { $admin } from \"./axios.js\";\n\nfunction getMemberList(params) {\n    return $admin().get(`/api/Manage/user`, { params });\n}\n// 设置用户停用、启用\nfunction setUserEnabled({ userId, enabled }) {\n    return $admin().put(`/api/Manage/user/${userId}/enabled/${enabled}`);\n}\n// 设置用户角色\nfunction setUserPermission({ userId, roleIds }) {\n    return $admin().post(`/api/Manage/user/${userId}/role`, { roleIds });\n}\n\nexport { getMemberList, setUserEnabled, setUserPermission };\n","<template>\n    <div class=\"m-member v-page\">\n        <!-- 搜索 -->\n        <div class=\"m-search-box\">\n            <search-bar :data=\"member_data\" @toSearch=\"onToSearch\" />\n        </div>\n        <!-- 表格 -->\n        <memberTable :table=\"state.table\" @toDialog=\"onToDialog\" v-loading=\"state.loading\" />\n        <!-- 分页 -->\n        <common-pagination :pagination=\"state.pagination\" @toParams=\"onToParams\" />\n        <!-- 提示弹窗 -->\n        <tipsDialog\n            class=\"m-tips\"\n            :dialog-object=\"dialogObject\"\n            @dialogClose=\"onDialogClose\"\n            @dialogSuccess=\"onTipsSuccess\"\n            v-if=\"dialogType == 'tips'\"\n        >\n            <div class=\"m-tips-content\">\n                <span class=\"u-title\">是否启用/停用成员帐号</span>\n                <span>{{ dialogObject.member.name }}</span>\n                <span>{{ dialogObject.member.role }}</span>\n                <span>{{ dialogObject.member.mobile }}</span>\n            </div>\n        </tipsDialog>\n        <!-- 授权 弹窗 -->\n        <userRoleFormDialog\n            class=\"m-form\"\n            :dialog-object=\"dialogObject\"\n            @dialogClose=\"onDialogClose\"\n            @dialogSuccess=\"onFormSuccess\"\n            v-if=\"dialogType == 'role'\"\n        />\n    </div>\n</template>\n<script setup>\nimport { reactive, ref, computed, onMounted } from \"vue\";\nimport memberTable from \"@/components/table/memberTable\";\nimport userRoleFormDialog from \"@/components/dialog/userRoleFormDialog\";\nimport { getMemberList, setUserEnabled, setUserPermission } from \"@/service/member\";\nimport { getRoles } from \"@/service/manage\";\nimport { ElNotification } from \"element-plus\";\n//====== 数据 ======\n\n// 搜索 默认选项数据\nconst member_data = computed(() => {\n    return {\n        uid: \"\",\n        placeholder: `按姓名、手机号码查找`,\n        status_title: \"-- 状态 --\",\n        status: [\n            {\n                label: \"全部\",\n                value: -1,\n            },\n            {\n                label: \"正常\",\n                value: 0,\n            },\n            {\n                label: \"已停用\",\n                value: 1,\n            },\n        ],\n        role_title: \"-- 角色 --\",\n        role: [\n            {\n                label: \"全部\",\n                value: -1,\n            },\n            ...state.role,\n        ],\n    };\n});\n\n// 表格 翻页\nlet state = reactive({\n    loading: false,\n    table: [],\n    pagination: {\n        page: 1,\n        per: 20,\n        total: 0,\n    },\n    search: {\n        Condition: null,\n        Status: null,\n        RoleId: null,\n    },\n    form: {},\n    role: [],\n});\n\n// axios查询数据\nconst params = computed(() => {\n    return {\n        pageIndex: state.pagination.page - 1,\n        pageSize: state.pagination.per,\n        ...state.search,\n    };\n});\n\n// 默认表单\nconst member = {};\n\n// 弹窗\nlet dialogType = ref(\"form\");\nlet dialogObject = reactive({\n    dialogVisible: false,\n    member: member,\n    role: [],\n});\n\n//====== 交互 ======\n\n// 搜索查询\nconst onToSearch = ({ input_txt, status_id, role_id }) => {\n    state.search.Condition = input_txt;\n    state.search.Status = status_id == -1 ? null : status_id;\n    state.search.RoleId = role_id == -1 ? null : role_id;\n    state.pagination.page = 1;\n    loadEMemberList();\n};\n\n// 翻页页码并搜索新的列表\nconst onToParams = (e) => {\n    state.pagination.page = e;\n    loadEMemberList();\n};\n\n// 关闭弹窗\nconst onDialogClose = () => {\n    dialogObject.dialogVisible = false;\n};\n\n// 打开弹窗\nconst onToDialog = ({ row, type }) => {\n    dialogObject.dialogVisible = true;\n    const _row = row ? row : member;\n    if (type == \"add\") _row.add = true;\n    dialogObject.member = _row;\n    dialogObject.role = state.role;\n    dialogType.value = type == \"close\" ? \"tips\" : \"role\";\n};\n// 表单弹窗确定\nconst onFormSuccess = (form) => {\n    dialogObject.dialogVisible = false;\n    const { userId, roleIds } = form;\n    setUserPermission({ userId, roleIds }).then(() => {\n        loadData();\n        ElNotification({\n            title: \"成功\",\n            message: \"设置权限成功\",\n            type: \"success\",\n        });\n    });\n};\n// 提示弹窗确定\nconst onTipsSuccess = () => {\n    const enabled = dialogObject.member.disabled == \"正常\" ? 1 : 0;\n    setUserEnabled({ userId: dialogObject.member.userId, enabled }).then(() => {\n        dialogObject.dialogVisible = false;\n        loadData();\n    });\n};\n\n//====== axios数据 ======\n\n// 初始加载\nonMounted(() => loadData());\n\n// 获取初始数据\nconst loadData = () => {\n    loadEMemberList();\n    loadRole();\n};\n// 获取成员列表\nconst loadEMemberList = () => {\n    state.loading = true;\n    getMemberList(params.value)\n        .then((res) => {\n            if (res.status == \"200\") {\n                const data = res.data.data;\n                state.table = data.datas;\n                state.pagination.total = data.totalCount;\n            }\n        })\n        .finally(() => (state.loading = false));\n};\n// 加载role列表\nconst loadRole = () => {\n    getRoles().then((res) => {\n        state.role = res.data.data.map((item) => {\n            item.label = item.name;\n            item.value = item.roleId;\n            return item;\n        });\n    });\n};\n</script>\n","import script from \"./MemberList.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./MemberList.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["addRole","data","$admin","post","editRole","put","delRole","id","delete","getRoles","get","getRoleId","setRolePermission","prmIds","getRolePermission","store","deepBerryStore","role","storeToRefs","hasEdit","computed","value","includes","hasEnabled","arr","hasOperate","map","item","filter","Boolean","length","state","reactive","handelClick","row","type","emit","watch","props","obj","table","deep","__exports__","emits","dialogShow","dialogObject","dialogVisible","set","val","roles","dialogTitle","title","dialogWidth","width","dialogCloseBtnText","closeBtnText","dialogSuccessBtnText","successBtnText","dialogIsFooter","isFooter","dialogContent","content","dialogForm","member","close","success","getMemberList","params","setUserEnabled","userId","enabled","setUserPermission","roleIds","member_data","uid","placeholder","status_title","status","label","role_title","loading","pagination","page","per","total","search","Condition","Status","RoleId","form","pageIndex","pageSize","dialogType","ref","onToSearch","input_txt","status_id","role_id","loadEMemberList","onToParams","e","onDialogClose","onToDialog","_row","add","onFormSuccess","then","loadData","ElNotification","message","onTipsSuccess","disabled","onMounted","loadRole","res","datas","totalCount","finally","name","roleId"],"sourceRoot":""}