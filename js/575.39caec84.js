"use strict";(self["webpackChunkomp"]=self["webpackChunkomp"]||[]).push([[575],{8354:function(e,l,a){a.d(l,{Aq:function(){return i},F3:function(){return u},_d:function(){return n},bG:function(){return t},hH:function(){return s},he:function(){return d},k8:function(){return r},yV:function(){return c}});var o=a(6146);function t(){return(0,o.u)().get("/api/Work/userInfo")}function n(e){return(0,o.u)().post("/api/Manage/role",e)}function i(e){return(0,o.u)().put("/api/Manage/role",e)}function r(e){return(0,o.u)().delete(`/api/Manage/role/${e}`)}function u(){return(0,o.u)().get("/api/Manage/role")}function s(e){return(0,o.u)().get(`/api/Manage/role/${e}`)}function d({id:e,prmIds:l}){return(0,o.u)().post(`/api/Manage/role/${e}/permission`,{prmIds:l})}function c(){return(0,o.u)().get("/api/Manage/permission")}},4575:function(e,l,a){a.r(l),a.d(l,{default:function(){return y}});var o=a(6252),t=a(2262),n=a(3577);const i={class:"u-table-button"},r=(0,o.Uk)("停用"),u=(0,o.Uk)("授权角色权限 ");var s={__name:"memberTable",props:{table:Array},emits:["toDialog"],setup(e,{emit:l}){const a=e;let s=(0,t.qj)({data:[]});function d(e,a){l("toDialog",{row:e,type:a})}return(0,o.YP)(a,(e=>{s.data=e.table,console.log(e)}),{deep:!0}),(l,a)=>{const t=(0,o.up)("el-table-column"),s=(0,o.up)("el-button"),c=(0,o.up)("el-table");return(0,o.wg)(),(0,o.j4)(c,{class:"m-table",data:e.table,border:"",style:{width:"100%"}},{default:(0,o.w5)((()=>[(0,o.Wm)(t,{prop:"userId",label:"userId"}),(0,o.Wm)(t,{prop:"name",label:"姓名",width:"180"}),(0,o.Wm)(t,{prop:"mobile",label:"手机号码",width:"180"}),(0,o.Wm)(t,{prop:"address",label:"部门"}),(0,o.Wm)(t,{prop:"role",label:"角色",width:"120"}),(0,o.Wm)(t,{prop:"disabled",label:"状态",width:"120"},{default:(0,o.w5)((e=>[(0,o._)("span",{class:(0,n.C_)("正常"===e.row.disabled?"u-table-normal":"u-table-disabled")},(0,n.zw)(e.row.disabled),3)])),_:1}),(0,o.Wm)(t,{label:"操作"},{default:(0,o.w5)((e=>[(0,o._)("div",i,[(0,o.Wm)(s,{link:"",type:"primary",size:"small",onClick:l=>d(e.row,"close")},{default:(0,o.w5)((()=>[r])),_:2},1032,["onClick"]),(0,o.Wm)(s,{link:"",type:"primary",size:"small",onClick:l=>d(e.row,"role")},{default:(0,o.w5)((()=>[u])),_:2},1032,["onClick"])])])),_:1})])),_:1},8,["data"])}}},d=a(3744);const c=(0,d.Z)(s,[["__scopeId","data-v-00a44f02"]]);var m=c;const p={key:0,class:"dialog-footer"},g={emits:["dialogClose","dialogSuccess"]};var b=Object.assign(g,{__name:"userRoleFormDialog",props:{dialogObject:Object},setup(e,{emit:l}){const a=e,i=(0,o.Fl)({get(){return a.dialogObject.dialogVisible},set(e){return e}}),r=(0,o.Fl)((()=>a.dialogObject.role)),u=(0,o.Fl)((()=>({dialogTitle:a.dialogObject.title||"角色权限",dialogWidth:a.dialogObject.width||"760px",dialogCloseBtnText:a.dialogObject.closeBtnText||"取消",dialogSuccessBtnText:a.dialogObject.successBtnText||"成功",dialogIsFooter:a.dialogObject.isFooter||!0,dialogContent:a.dialogObject.content||"是否停用",dialogForm:a.dialogObject.member||{}}))),s=()=>{l("dialogClose")},d=()=>{l("dialogSuccess",u.value.dialogForm)};return(e,l)=>{const a=(0,o.up)("el-form-item"),c=(0,o.up)("el-option"),m=(0,o.up)("el-select"),g=(0,o.up)("el-form"),b=(0,o.up)("el-button"),f=(0,o.up)("el-dialog");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o.Wm)(f,{modelValue:(0,t.SU)(i),"onUpdate:modelValue":l[1]||(l[1]=e=>(0,t.dq)(i)?i.value=e:null),title:(0,t.SU)(u).dialogTitle,width:(0,t.SU)(u).dialogWidth,"before-close":s,draggable:""},{footer:(0,o.w5)((()=>[(0,t.SU)(u).dialogIsFooter?((0,o.wg)(),(0,o.iD)("span",p,[(0,o.Wm)(b,{onClick:s},{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)((0,t.SU)(u).dialogCloseBtnText),1)])),_:1}),(0,o.Wm)(b,{type:"primary",onClick:d},{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)((0,t.SU)(u).dialogSuccessBtnText),1)])),_:1})])):(0,o.kq)("",!0)])),default:(0,o.w5)((()=>[(0,o.Wm)(g,{class:"m-form-content",model:(0,t.SU)(u).dialogForm,"label-width":"120px"},{default:(0,o.w5)((()=>[(0,o.Wm)(a,{label:"姓名"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)((0,t.SU)(u).dialogForm.name||"-"),1)])),_:1}),(0,o.Wm)(a,{label:"手机号码"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)((0,t.SU)(u).dialogForm.mobile||"-"),1)])),_:1}),(0,o.Wm)(a,{label:"授权角色"},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{modelValue:(0,t.SU)(u).dialogForm.role,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,t.SU)(u).dialogForm.role=e),placeholder:"请选择角色"},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,t.SU)(r),((e,l)=>((0,o.wg)(),(0,o.j4)(c,{key:l,label:e.name,value:e.role},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","title","width"])])}}});const f=b;var w=f,_=a(6146);function S(e){return(0,_.u)().get("/api/Manage/user",{params:e})}function U({userId:e,enabled:l}){return(0,_.u)().put(`/api/Manage/uer/${e}/enabled/${l}`)}var h=a(8354);const v={class:"m-member v-page"},k={class:"m-search-box"},j={class:"m-tips-content"},W=(0,o._)("span",{class:"u-title"},"是否启用/停用成员帐号",-1);var C={__name:"MemberList",setup(e){const l=(0,o.Fl)((()=>({uid:"",placeholder:"按姓名、手机号码查找",status_title:"-- 状态 --",status:[{label:"全部",value:-1},{label:"正常",value:0},{label:"已停用",value:1}],role_title:"-- 角色 --",role:[{label:"全部",value:-1},...a.role]})));let a=(0,t.qj)({loading:!1,table:[],pagination:{page:1,per:20,total:0},search:{Condition:null,Status:null,RoleId:null},form:{},role:[]});const i=(0,o.Fl)((()=>({pageIndex:a.pagination.page-1,pageSize:a.pagination.per,...a.search}))),r={};let u=(0,t.iH)("form"),s=(0,t.qj)({dialogVisible:!1,member:r,role:a.role});const d=({input_txt:e,status_id:l,role_id:o})=>{a.search.Condition=e,a.search.Status=-1==l?null:l,a.search.RoleId=-1==o?null:o,a.pagination.page=1,C()},c=e=>{a.pagination.page=e,C()},p=()=>{s.dialogVisible=!1},g=({row:e,type:l})=>{s.dialogVisible=!0,console.log(e);const a=e||r;"add"==l&&(a.add=!0),s.member=a,u.value="close"==l?"tips":"role"},b=e=>{s.dialogVisible=!1},f=()=>{const e="正常"==s.member.disabled?1:0;U({userId:s.member.userId,enabled:e}).then((e=>{console.log(e)}))};(0,o.bv)((()=>_()));const _=()=>{C(),F()},C=()=>{a.loading=!0,S(i.value).then((e=>{if("200"==e.status){const l=e.data.data;a.table=l.datas,a.pagination.total=l.totalCount}})).finally((()=>a.loading=!1))},F=()=>{(0,h.F3)().then((e=>{a.role=e.data.data.map((e=>(e.label=e.name,e.value=e.roleId,e)))}))};return(e,i)=>{const r=(0,o.up)("search-bar"),_=(0,o.up)("common-pagination"),S=(0,o.up)("tipsDialog"),U=(0,o.Q2)("loading");return(0,o.wg)(),(0,o.iD)("div",v,[(0,o._)("div",k,[(0,o.Wm)(r,{data:(0,t.SU)(l),onToSearch:d},null,8,["data"])]),(0,o.wy)((0,o.Wm)((0,t.SU)(m),{table:(0,t.SU)(a).table,onToDialog:g},null,8,["table"]),[[U,(0,t.SU)(a).loading]]),(0,o.Wm)(_,{pagination:(0,t.SU)(a).pagination,onToParams:c},null,8,["pagination"]),"tips"==(0,t.SU)(u)?((0,o.wg)(),(0,o.j4)(S,{key:0,class:"m-tips","dialog-object":(0,t.SU)(s),onDialogClose:p,onDialogSuccess:f},{default:(0,o.w5)((()=>[(0,o._)("div",j,[W,(0,o._)("span",null,(0,n.zw)((0,t.SU)(s).member.name),1),(0,o._)("span",null,(0,n.zw)((0,t.SU)(s).member.role),1),(0,o._)("span",null,(0,n.zw)((0,t.SU)(s).member.mobile),1)])])),_:1},8,["dialog-object"])):(0,o.kq)("",!0),"role"==(0,t.SU)(u)?((0,o.wg)(),(0,o.j4)((0,t.SU)(w),{key:1,class:"m-form","dialog-object":(0,t.SU)(s),onDialogClose:p,onDialogSuccess:b},null,8,["dialog-object"])):(0,o.kq)("",!0)])}}};const F=C;var y=F}}]);
//# sourceMappingURL=575.39caec84.js.map