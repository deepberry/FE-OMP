(function(){var e={6128:function(e,t,a){"use strict";var o=a(9963),l=a(6252),n=a(2262),i=a(3577);const r={class:"m-footer"};function u(e,t,a,o,n,i){return(0,l.wg)(),(0,l.iD)("footer",r)}var s={name:"CommonFooter",props:[],components:{},data:function(){return{}},computed:{},watch:{},methods:{},created:function(){},mounted:function(){}},c=a(3744);const d=(0,c.Z)(s,[["render",u]]);var p=d,m=a(2908),g=a(8825),f=a(1575);const b={class:"m-navigation"},v={class:"m-navigation-logo"},w=["src"],h=(0,l._)("span",{class:"u-title"},"深莓智能运营管理平台",-1),_={class:"m-navigation-ul"},y=(0,l._)("b",{class:"u-icon"},"▷",-1),S={class:"u-label"};var k={__name:"commonNavigation",setup(e){const t=(0,g.t)(),{role:a}=(0,f.Jk)(t),o={name:"企业管理",value:"company",icon:"Postcard"},r={name:"用户管理",value:"customer",icon:"User"},u={name:"设备管理",value:"equipment",icon:"SetUp"},s=(0,l.Fl)((()=>{let e=[];const{company:l,customer:n,equipment:i}=t.roleData;return a.value.forEach((t=>{l[t]&&(e[0]=o),n[t]&&(e[1]=r),i[t]&&(e[2]=u)})),console.log("用户可查看：",...e.filter(Boolean).map((e=>e.name))),e.filter(Boolean)}));return(e,t)=>{const a=(0,l.up)("router-link");return(0,l.wg)(),(0,l.iD)("div",b,[(0,l._)("div",v,[(0,l._)("img",{class:"u-logo",src:(0,n.SU)(m),alt:"深莓智能"},null,8,w),h]),(0,l._)("ul",_,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)((0,n.SU)(s),(e=>((0,l.wg)(),(0,l.iD)("li",{class:"u-item",key:e.value},[(0,l.Wm)(a,{class:"u-txt",to:{name:e.value}},{default:(0,l.w5)((()=>[y,(0,l._)("span",S,(0,i.zw)(e.name),1)])),_:2},1032,["to"])])))),128))])])}}};const U=k;var j=U;const D={class:"m-setting"},W={class:"m-list"};var I={__name:"asideSetting",setup(e){const t=(0,g.t)(),{role:a,roleData:o}=(0,f.Jk)(t),r={path:"/role",label:"角色权限"},u={path:"/role/member",label:"成员列表"},s=(0,l.Fl)((()=>{let e=[{path:"/role/details/1",label:"当前账号"}];const{manage:t,user:l}=o.value;return a.value.forEach((a=>{l[a]&&(e[1]=u),t[a]&&(e[2]=r)})),e.filter(Boolean)}));return(e,t)=>{const a=(0,l.up)("Setting"),o=(0,l.up)("router-link"),r=(0,l.up)("el-popover");return(0,l.wg)(),(0,l.iD)("div",D,[(0,l.Wm)(r,{"popper-class":"m-popper-setting",placement:"top",width:"180px",trigger:"hover"},{reference:(0,l.w5)((()=>[(0,l.Wm)(a,{class:"u-setting"})])),default:(0,l.w5)((()=>[(0,l._)("div",W,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)((0,n.SU)(s),((e,t)=>((0,l.wg)(),(0,l.j4)(o,{to:e.path,class:"u-item",key:t},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(e.label),1)])),_:2},1032,["to"])))),128))])])),_:1})])}}};const O=I;var z=O,C=a(9053),V=a(4460),q=a(340),T=JSON.parse('{"L1":{"home":{"title":"运营平台","tab_name":"首页","icon":"House"},"company":{"title":"企业信息管理","key_name":"企业","tab_name":"企业管理","icon":"Postcard"},"customer":{"title":"用户信息管理","key_name":"用户","tab_name":"用户管理","icon":"User"},"equipment":{"title":"设备信息管理","key_name":"设备","tab_name":"设备管理","icon":"SetUp"},"role":{"title":"角色权限","key_name":"角色","tab_name":"角色","icon":"Setting"},"details":{"title":"详情","key_name":"详情","tab_name":"详情","icon":"Document"}}}'),N=a(2201);const x={class:"m-container"},F={class:"m-aside"},B={class:"m-main"},P={key:0,class:"m-title"},A={class:"u-title-txt"},L={key:1,class:"m-title"},E={class:"u-title-txt"};var $={__name:"App",setup(e){const t=(0,g.t)(),a=(0,N.yj)(),o=(0,n.qj)((0,N.tv)());let{label:r,data:u,role:s}=(0,f.Jk)(t);r=(0,n.IU)(a).name,u=T.L1,t.label=r,t.data=u,t.role=s;const c=(0,n.qj)({view:{icon:"",title:""}}),d=(0,n.iH)("");C["default"],V["default"],q["default"],(0,l.YP)(r,(e=>{var t,a;d.value=e,c.view.icon=(null===(t=u[e])||void 0===t?void 0:t.icon)||"Notebook",c.view.title=(null===(a=u[e])||void 0===a?void 0:a.title)||"成员列表"}),{immediate:!0});const m=(0,l.Fl)((()=>"role"==a.params.type&&0==a.params.id)),b=(0,l.Fl)((()=>u[a.params.type].key_name));function v(){o.go(-1)}return(e,t)=>{const o=(0,l.up)("el-page-header"),u=(0,l.up)("router-view");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",x,[(0,l._)("aside",F,[(0,l.Wm)(j),(0,l.Wm)(z)]),(0,l._)("main",B,["details"==(0,n.SU)(r)?((0,l.wg)(),(0,l.iD)("h2",P,[(0,l._)("span",A,[(0,n.SU)(m)?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(o,{key:0,title:"返回",onBack:v})),(0,l.Uk)(" "+(0,i.zw)((0,n.SU)(b))+"详情",1)])])):((0,l.wg)(),(0,l.iD)("h2",L,[(0,l._)("span",E,[c.view.title?((0,l.wg)(),(0,l.j4)((0,l.LL)(c.view.icon),{key:0,class:"u-title-icon"})):(0,l.kq)("",!0),(0,l.Uk)((0,i.zw)(c.view.title),1)])])),(0,l.Wm)(u,null,{default:(0,l.w5)((({Component:e})=>[((0,l.wg)(),(0,l.j4)(l.Ob,null,[(0,n.SU)(a).meta.keepAlive?((0,l.wg)(),(0,l.j4)((0,l.LL)(e),{key:(0,n.SU)(a).name})):(0,l.kq)("",!0)],1024)),(0,n.SU)(a).meta.keepAlive?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)((0,l.LL)(e),{key:(0,n.SU)(a).name}))])),_:1})])]),(0,l.Wm)(p)],64)}}};const H=$;var Y=H,M=a(1232),J=a(826);const K=()=>a.e(795).then(a.bind(a,3795)),Z=()=>Promise.resolve().then(a.bind(a,9053)),Q=()=>Promise.resolve().then(a.bind(a,4460)),G=()=>Promise.resolve().then(a.bind(a,340)),R=()=>a.e(306).then(a.bind(a,5306)),X=()=>a.e(912).then(a.bind(a,9912)),ee=()=>a.e(929).then(a.bind(a,9929)),te=[{name:"home",path:"/",component:K},{name:"company",path:"/company",component:Z,meta:{keepAlive:!0}},{name:"customer",path:"/customer",component:Q,meta:{keepAlive:!0}},{name:"equipment",path:"/equipment",component:G,meta:{keepAlive:!0}},{name:"details",path:"/:type/details/:id",component:R,meta:{keepAlive:!1}},{name:"role",path:"/role/:id?",component:X,meta:{keepAlive:!1}},{name:"member",path:"/role/member",component:ee,meta:{keepAlive:!0}}],ae=(0,N.p7)({history:(0,N.r5)(),routes:te});ae.beforeEach(((e,t,a)=>{a()}));var oe=ae,le=a(5929);const ne=(0,f.WB)();ne.use(le.Z);var ie=ne,re=a(8958),ue=(a(4415),a(1415)),se=a.n(ue),ce=a(5781);const de={class:"m-searchBar"},pe=(0,l.Uk)("查询");var me={__name:"searchBar",props:{data:Object},emits:["toSearch"],setup(e,{emit:t}){const a=(0,n.qj)({input_txt:"",status_id:"",bind_id:"",connect_id:"",role_id:"",type_id:""});function i(){let e={};Object.keys(a).forEach((t=>{const o=a[t],l=""===o||null===o||void 0===o;l||(e[t]=o)})),t("toSearch",e)}return(t,n)=>{const r=(0,l.up)("Search"),u=(0,l.up)("el-input"),s=(0,l.up)("el-option"),c=(0,l.up)("el-select"),d=(0,l.up)("el-button");return(0,l.wg)(),(0,l.iD)("div",de,[(0,l.Wm)(u,{modelValue:a.input_txt,"onUpdate:modelValue":n[0]||(n[0]=e=>a.input_txt=e),modelModifiers:{lazy:!0},class:"u-input",placeholder:e.data.placeholder,onKeyup:(0,o.D2)(i,["enter"])},(0,l.Nv)({_:2},[e.data.role?{name:"prepend",fn:(0,l.w5)((()=>[(0,l.Wm)(r,{class:"u-icon"})]))}:void 0]),1032,["modelValue","placeholder","onKeyup"]),e.data.status?((0,l.wg)(),(0,l.j4)(c,{key:0,modelValue:a.status_id,"onUpdate:modelValue":n[1]||(n[1]=e=>a.status_id=e),class:"u-select",placeholder:e.data.status_title},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.data.status,((e,t)=>((0,l.wg)(),(0,l.j4)(s,{key:t,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","placeholder"])):(0,l.kq)("",!0),e.data.type?((0,l.wg)(),(0,l.j4)(c,{key:1,modelValue:a.type_id,"onUpdate:modelValue":n[2]||(n[2]=e=>a.type_id=e),class:"u-select",placeholder:e.data.type_title},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.data.type,((e,t)=>((0,l.wg)(),(0,l.j4)(s,{key:t,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","placeholder"])):(0,l.kq)("",!0),e.data.bind?((0,l.wg)(),(0,l.j4)(c,{key:2,modelValue:a.bind_id,"onUpdate:modelValue":n[3]||(n[3]=e=>a.bind_id=e),class:"u-select",placeholder:e.data.bind_title},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.data.bind,((e,t)=>((0,l.wg)(),(0,l.j4)(s,{key:t,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","placeholder"])):(0,l.kq)("",!0),e.data.connect?((0,l.wg)(),(0,l.j4)(c,{key:3,modelValue:a.connect_id,"onUpdate:modelValue":n[4]||(n[4]=e=>a.connect_id=e),class:"u-select",placeholder:e.data.connect_title},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.data.connect,((e,t)=>((0,l.wg)(),(0,l.j4)(s,{key:t,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","placeholder"])):(0,l.kq)("",!0),e.data.role?((0,l.wg)(),(0,l.j4)(c,{key:4,modelValue:a.role_id,"onUpdate:modelValue":n[5]||(n[5]=e=>a.role_id=e),class:"u-select",placeholder:e.data.role_title},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.data.role,((e,t)=>((0,l.wg)(),(0,l.j4)(s,{key:t,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","placeholder"])):(0,l.kq)("",!0),(0,l.Wm)(d,{type:"primary",class:"u-button",onClick:i},{default:(0,l.w5)((()=>[pe])),_:1})])}}};const ge=me;var fe=ge;const be={class:"m-pagination"};var ve={__name:"paginationPage",props:{pagination:Object},emits:["toParams"],setup(e,{emit:t}){const a=e,o=(0,n.qj)({page:1,per:10,total:0,single:!0});function i(e){t("toParams",e)}return(0,l.YP)(a.pagination,(e=>{o.page=e.page,o.per=e.per,o.total=e.total,o.single=!(o.total>o.per)}),{deep:!0,immediate:!0}),(e,t)=>{const a=(0,l.up)("el-pagination");return(0,l.wg)(),(0,l.iD)("div",be,[(0,l.Wm)(a,{"hide-on-single-page":o.single,currentPage:o.page,"onUpdate:currentPage":t[0]||(t[0]=e=>o.page=e),"page-size":o.per,"onUpdate:page-size":t[1]||(t[1]=e=>o.per=e),background:"",layout:"total, prev, pager, next, jumper",total:o.total,onCurrentChange:i},null,8,["hide-on-single-page","currentPage","page-size","total"])])}}};const we=ve;var he=we;const _e={key:0,class:"dialog-footer"},ye={emits:["dialogClose","dialogSuccess"]};var Se=Object.assign(ye,{__name:"tipsDialog",props:{dialogObject:Object},setup(e,{emit:t}){const a=e,o=(0,l.Fl)({get(){return a.dialogObject.dialogVisible},set(e){return e}}),r=(0,l.Fl)((()=>({dialogTitle:a.dialogObject.title||"Tips",dialogWidth:a.dialogObject.width||"760px",dialogCloseBtnText:a.dialogObject.closeBtnText||"取消",dialogSuccessBtnText:a.dialogObject.successBtnText||"确定",dialogIsFooter:a.dialogObject.isFooter||!0,dialogContent:a.dialogObject.content||"是否停用"}))),u=()=>{t("dialogClose")},s=()=>{t("dialogSuccess")};return(e,t)=>{const a=(0,l.up)("el-button"),c=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l.Wm)(c,{modelValue:(0,n.SU)(o),"onUpdate:modelValue":t[0]||(t[0]=e=>(0,n.dq)(o)?o.value=e:null),title:(0,n.SU)(r).dialogTitle,width:(0,n.SU)(r).dialogWidth,"before-close":u,draggable:""},{footer:(0,l.w5)((()=>[(0,n.SU)(r).dialogIsFooter?((0,l.wg)(),(0,l.iD)("span",_e,[(0,l.Wm)(a,{onClick:u},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)((0,n.SU)(r).dialogCloseBtnText),1)])),_:1}),(0,l.Wm)(a,{type:"primary",onClick:s},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)((0,n.SU)(r).dialogSuccessBtnText),1)])),_:1})])):(0,l.kq)("",!0)])),default:(0,l.w5)((()=>[(0,l.WI)(e.$slots,"default")])),_:3},8,["modelValue","title","width"])])}}});const ke=Se;var Ue=ke,je={install:function(e){e.component("searchBar",fe),e.component("commonPagination",he),e.component("tipsDialog",Ue)}};const De=(0,o.ri)(Y),We=(0,M.G6)();De.use(We),De.use(J.Z),De.use(oe),De.use(ie),De.use(re.Z);const Ie=new(se());De.use(Ie);for(const[Oe,ze]of Object.entries(ce))De.component(Oe,ze);De.use(je),De.mount("#app")},6146:function(e,t,a){"use strict";a.d(t,{u:function(){return s}});var o=a(9669),l=a.n(o),n=a(129),i=a.n(n),r=a(1348);function u(e,t){e.interceptors.response.use((e=>e),(e=>(e.response.data&&(0,r.z8)({type:"error",message:"code:"+e.response.data.httpCode+"=>"+e.response.data.msg}),Promise.reject(e))))}function s(e){let t={baseURL:"https://admin.deepberry.cn:444",headers:{Authorization:localStorage&&localStorage.getItem("token")||"",Accept:"text/pain"}};t.data=i().stringify(t.data);const a=l().create(t);return u(a,e),a}},2941:function(e,t,a){"use strict";a.d(t,{Ge:function(){return c},ji:function(){return i},lQ:function(){return n},m_:function(){return l},mz:function(){return r},oS:function(){return u},yG:function(){return s}});var o=a(6146);function l(e){return(0,o.u)().get("/api/Orgz",{params:e})}function n(e){return(0,o.u)().post("/api/Orgz",e)}function i(e){return(0,o.u)().put("/api/Orgz",e)}function r(e,t){return(0,o.u)().put(`/api/Orgz/${e}/enabled/${t}`)}function u(e){return(0,o.u)().get(`/api/Orgz/${e}`)}function s(){return(0,o.u)().get("/api/Orgz/total")}function c(e){return(0,o.u)().get(`/api/Work/user/onelogin/${e}`)}},999:function(e,t,a){"use strict";a.d(t,{O3:function(){return i},c0:function(){return r},lz:function(){return n},wN:function(){return l}});var o=a(6146);function l(e){return(0,o.u)().get("/api/User",{params:e})}function n(e,t){return(0,o.u)().put(`/api/User/${e}/enabled/${t}`)}function i(e){return(0,o.u)().get(`/api/User/${e}`)}function r(e){return(0,o.u)().put(`/api/User/${e}/reset`)}},3727:function(e,t,a){"use strict";a.d(t,{Ol:function(){return i},Q$:function(){return r},ag:function(){return n},cB:function(){return u},eM:function(){return l},hf:function(){return d},i2:function(){return c},v$:function(){return p},wk:function(){return s}});var o=a(6146);function l(e){return(0,o.u)().get("/api/Device",{params:e})}function n(e){return(0,o.u)().post("/api/Device",e)}function i(e){return(0,o.u)().put("/api/Device",e)}function r(e){return(0,o.u)().get(`/api/Device/${e}`)}function u(){return(0,o.u)().get("/api/Device/type")}function s(e){return(0,o.u)().get(`/api/Device/tracking?deviceId=${e}`)}function c(e){return(0,o.u)().post("/api/Device/tracking",e)}function d(e){return(0,o.u)().get("/api/Device/operationLogPage",{params:e})}function p(e){return(0,o.u)().get(`/api/Device/${e}`)}},8825:function(e,t,a){"use strict";a.d(t,{t:function(){return n}});var o=a(1575),l=JSON.parse('{"23":"当前账号","equipment":{"7":"设备管理全部权限","18":"查看设备列表权限","19":"添加设备权限","20":"查看设备详情权限","21":"修改设备权限"},"customer":{"6":"用户管理全部权限","14":"查看用户列表权限","15":"用户启用/停用权限","17":"查看用户详情权限"},"company":{"5":"企业管理全部权限","8":"查看企业客户列表权限","9":"企业开户权限","10":"企业客户启用/停用权限","12":"查看企业客户详情权限","13":"修改企业客户信息权限"},"user":{"24":"成员列表","26":"查询成员","28":"角色列表","30":"启/停用","31":"授权角色权限"},"manage":{"25":"角色权限全部权限","29":"功能权限","32":"新建角色","33":"编辑角色信息","34":"删除角色","35":"查看权限列表权限","36":"编辑角色权限","37":"复制权限并新建角色权限"}}');const n=(0,o.Q_)("deepBerry",{state:()=>({data:{},label:"",role:[],roleData:l}),persist:{enabled:!0,strategies:[{storage:localStorage,paths:["role","data"]}]},getters:{},actions:{}})},9053:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return P}});a(6699);var o=a(6252),l=a(2262),n=a(3577),i=a(8825),r=a(393);const u={class:"u-table-img"},s=["src"],c={class:"u-table-button"},d=["onClick"],p=["onClick"],m=(0,o.Uk)("查看详情 ");var g={__name:"companyTable",props:{table:Array,label:String},emits:["toDialog"],setup(e,{emit:t}){const a=e,g=r.CJ,f=(0,i.t)(),b=(0,o.Fl)((()=>f.role.includes(13))),v=(0,o.Fl)((()=>f.role.includes(12))),w=(0,o.Fl)((()=>f.role.includes(10))),h=[10,12,13],_=(0,o.Fl)((()=>f.role.map((e=>h.includes(e))).filter(Boolean).length));let y=(0,l.qj)({data:[]});const S="https://www.deepberry.cn/images/placeholders/logo.png";function k(e,a){t("toDialog",{row:e,type:a})}return(0,o.YP)(a,(e=>{y.data=e.table}),{deep:!0}),(t,a)=>{const i=(0,o.up)("el-table-column"),r=(0,o.up)("router-link"),f=(0,o.up)("el-table");return(0,o.wg)(),(0,o.j4)(f,{class:"m-table",data:(0,l.SU)(y).data,border:"","row-key":"organizationId",fit:"",style:{width:"100%"}},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{prop:"organizationId",label:"企业ID",width:"120"}),(0,o.Wm)(i,{prop:"orgzName",label:"企业名称"}),(0,o.Wm)(i,{label:"企业Logo"},{default:(0,o.w5)((e=>[(0,o._)("div",u,[(0,o._)("img",{src:(0,l.SU)(g)(e.row.orgzLogo)||S},null,8,s)])])),_:1}),(0,o.Wm)(i,{prop:"contact",label:"联系人",width:"200"}),(0,o.Wm)(i,{prop:"accountName",label:"企业主账号",width:"200"}),(0,o.Wm)(i,{prop:"phoneNum",label:"手机号码",width:"200"}),(0,o.Wm)(i,{label:"企业状态",width:"120"},{default:(0,o.w5)((e=>[(0,o._)("span",{class:(0,n.C_)("禁用"===e.row.status?"u-table-disabled":"u-table-normal")},(0,n.zw)("禁用"===e.row.status?"已停用":e.row.status),3)])),_:1}),(0,o.Wm)(i,{prop:"createAt",label:"账户创建时间",width:"240"}),(0,l.SU)(_)?((0,o.wg)(),(0,o.j4)(i,{key:0,label:"操作",width:"280"},{default:(0,o.w5)((t=>[(0,o._)("div",c,[(0,l.SU)(w)?((0,o.wg)(),(0,o.iD)("span",{key:0,onClick:e=>k(t.row,"close")},(0,n.zw)("正常"==t.row.status?"停用":"启用"),9,d)):(0,o.kq)("",!0),(0,l.SU)(b)?((0,o.wg)(),(0,o.iD)("span",{key:1,onClick:e=>k(t.row,"edit")},"编辑",8,p)):(0,o.kq)("",!0),(0,l.SU)(v)&&t.row.organizationId?((0,o.wg)(),(0,o.j4)(r,{key:2,to:{path:`/${e.label}/details/${t.row.organizationId}`},class:"u-table-more"},{default:(0,o.w5)((()=>[m])),_:2},1032,["to"])):(0,o.kq)("",!0)])])),_:1})):(0,o.kq)("",!0)])),_:1},8,["data"])}}},f=a(3744);const b=(0,f.Z)(g,[["__scopeId","data-v-9475e338"]]);var v=b,w=(a(1703),a(6486)),h=a.n(w),_=a(2036);const y=(0,_.n)({headers:{Authorization:localStorage.getItem("token")}});function S(e){return y.post("/api/cms/system/upload/via/omp",e)}var k=a(9996);const U={class:"m-box"},j=(0,o._)("div",{class:"u-tips"},[(0,o._)("span",null," 尺寸建议：宽180 x 高60"),(0,o._)("span",null," 格式建议：透明背景图片，PNG或gif,logo图形使用深色")],-1),D={key:0,class:"dialog-footer"},W={emits:["dialogClose","dialogSuccess"]};var I=Object.assign(W,{__name:"companyFormDialog",props:{dialogObject:Object},setup(e,{emit:t}){const a=e,i=(0,o.Fl)((()=>a.dialogObject.company));let u=(0,l.qj)({form:{},logoUrl:""});const s=(e,t,a)=>{if(t){const e=/^[1][3,4,5,7,8,9][0-9]{9}$/;e.test(t)?a():a(new Error("请输入正确的手机号"))}else u.form.phoneNum||u.form.accountName?a():a(new Error("主账号或手机必填一项"))},c=(e,t,a)=>{if(t)if(t.length<2)a(new Error("请输入至少2-16位数的账号"));else{const e=/[a-zA-Z]+/;e.test(t)?a():a(new Error("主账号必须包含字母"))}else u.form.phoneNum||u.form.accountName?a():a(new Error("主账号或手机必填一项"))},d=(0,l.iH)(""),p=(0,l.iH)({orgzName:[{required:!0,message:"请输入企业名称",trigger:"blur"}],contact:[{required:!0,message:"请输入企业联系人",trigger:"blur"}],accountName:[{validator:c,trigger:"blur"}],phoneNum:[{validator:s,trigger:"blur"}]}),m=(0,o.Fl)({get(){return a.dialogObject.dialogVisible},set(e){return e}}),g=(0,o.Fl)((()=>({dialogTitle:a.dialogObject.title||"企业信息",dialogWidth:a.dialogObject.width||"780px",dialogCloseBtnText:a.dialogObject.closeBtnText||"取消",dialogSuccessBtnText:a.dialogObject.successBtnText||"确定",dialogIsFooter:a.dialogObject.isFooter||!0})));(0,o.YP)(i,(e=>{u.form=e.add?{}:h().cloneDeep(e)}),{deep:!0,immediate:!0});const f=()=>{t("dialogClose"),d.value.resetFields(),u.form={}},b=e=>{e&&e.validate(((e,a)=>{e?(u.logoUrl&&(u.form.orgzLogo=u.logoUrl),t("dialogSuccess",u.form)):console.log("error submit!",a)}))},v=e=>{if(e){let t=new FormData;t.append("file",e),t.append("path","logos"),S(t).then((e=>{u.logoUrl=(0,r.CJ)(e.data.data.name),(0,k.bM)({title:"成功",message:"上传成功",type:"success"})}))}};return(e,t)=>{const a=(0,o.up)("el-input"),i=(0,o.up)("el-form-item"),r=(0,o.up)("UploadImage"),s=(0,o.up)("el-form"),c=(0,o.up)("el-button"),w=(0,o.up)("el-dialog");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o.Wm)(w,{modelValue:(0,l.SU)(m),"onUpdate:modelValue":t[5]||(t[5]=e=>(0,l.dq)(m)?m.value=e:null),title:(0,l.SU)(g).dialogTitle,width:(0,l.SU)(g).dialogWidth,"before-close":f,draggable:""},{footer:(0,o.w5)((()=>[(0,l.SU)(g).dialogIsFooter?((0,o.wg)(),(0,o.iD)("span",D,[(0,o.Wm)(c,{onClick:f},{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)((0,l.SU)(g).dialogCloseBtnText),1)])),_:1}),(0,o.Wm)(c,{type:"primary",onClick:t[4]||(t[4]=e=>b(d.value))},{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)((0,l.SU)(g).dialogSuccessBtnText),1)])),_:1})])):(0,o.kq)("",!0)])),default:(0,o.w5)((()=>[(0,o.Wm)(s,{class:"m-form-content",ref_key:"formRef",ref:d,model:(0,l.SU)(u).form,rules:p.value,"label-width":"120px"},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{label:"企业名称",prop:"orgzName"},{default:(0,o.w5)((()=>[(0,o.Wm)(a,{modelValue:(0,l.SU)(u).form.orgzName,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,l.SU)(u).form.orgzName=e)},null,8,["modelValue"])])),_:1}),(0,o.Wm)(i,{label:"企业/组织Logo"},{default:(0,o.w5)((()=>[(0,o._)("div",U,[(0,o.Wm)(r,{class:"m-uploader",url:(0,l.SU)(u).logoUrl,width:"180px",height:"120px",onUpdate:v},null,8,["url"]),j])])),_:1}),(0,o.Wm)(i,{label:"联系人",prop:"contact"},{default:(0,o.w5)((()=>[(0,o.Wm)(a,{modelValue:(0,l.SU)(u).form.contact,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,l.SU)(u).form.contact=e)},null,8,["modelValue"])])),_:1}),(0,o.Wm)(i,{label:"手机号码",prop:"phoneNum"},{default:(0,o.w5)((()=>[(0,o.Wm)(a,{modelValue:(0,l.SU)(u).form.phoneNum,"onUpdate:modelValue":t[2]||(t[2]=e=>(0,l.SU)(u).form.phoneNum=e),placeholder:"手机号码和用户账号可以二选一填写"},null,8,["modelValue"])])),_:1}),(0,o.Wm)(i,{label:"企业主账号",prop:"accountName"},{default:(0,o.w5)((()=>[(0,o.Wm)(a,{modelValue:(0,l.SU)(u).form.accountName,"onUpdate:modelValue":t[3]||(t[3]=e=>(0,l.SU)(u).form.accountName=e),placeholder:"2-16位的字符串（必须含字母）"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title","width"])])}}});const O=I;var z=O,C=a(2941);const V={class:"v-company v-page"},q={class:"m-search-box"},T=(0,o.Uk)("企业开户"),N={class:"m-tips-content"},x=(0,o._)("span",{class:"u-title"},"是否启用/停用企业账户",-1);var F={__name:"CompanyList",setup(e){const t=(0,i.t)(),a={placeholder:"请输入企业ID/企业名称/联系人/联系电话",status_title:"-- 企业账户状态 --",status:[{label:"全部",value:-1},{label:"正常",value:0},{label:"已停用",value:1}]};let r=(0,l.qj)({loading:!1,table:[],pagination:{page:1,per:20,total:0},search:{input:null,status:null},form:{}});const u=(0,o.Fl)((()=>({pageIndex:r.pagination.page-1,pageSize:r.pagination.per,Condition:r.search.input,Status:r.search.status}))),s={organizationId:"",orgzLogo:"",orgzName:"",phoneNum:"",userId:"",userName:"",accountName:"",contact:""};let c=(0,l.iH)("form"),d=(0,l.qj)({dialogVisible:!1,company:s});const p=(0,o.Fl)((()=>t.role.includes(9)));function m({input_txt:e,status_id:t}){r.search.input=e,r.search.status=-1==t?null:t,r.pagination.page=1,y()}function g(e){r.pagination.page=e,y()}function f({row:e,type:t}){d.dialogVisible=!0;const a=e?h().cloneDeep(e):s;"add"==t&&(a.add=!0),d.company=a,c.value="close"==t?"tips":"form"}const b=()=>{d.dialogVisible=!1},w=()=>{const{organizationId:e,status:t}=d.company,a="正常"==t?1:0,o=0==a?"启用":"停用";(0,C.mz)(e,a).then((()=>{d.dialogVisible=!1,y(),(0,k.bM)({title:"成功",message:`${o}企业成功`,type:"success"})}))},_=e=>{d.dialogVisible=!1,e.logo=e.orgzLogo,e.organizationId?(0,C.ji)(e).then((()=>{(0,k.bM)({title:"成功",message:"修改企业信息成功",type:"success"}),y()})):(0,C.lQ)(e).then((()=>{(0,k.bM)({title:"成功",message:"添加企业成功",type:"success"}),y()}))};function y(){r.loading=!0,(0,C.m_)(u.value).then((e=>{if("200"==e.status){const t=e.data.data;r.table=t.datas,r.pagination.total=t.totalCount}})).finally((()=>r.loading=!1))}return(0,o.bv)((()=>y())),(e,i)=>{const u=(0,o.up)("search-bar"),s=(0,o.up)("el-button"),h=(0,o.up)("commonPagination"),y=(0,o.up)("tipsDialog"),S=(0,o.Q2)("loading");return(0,o.wg)(),(0,o.iD)("div",V,[(0,o._)("div",q,[(0,o.Wm)(u,{data:a,onToSearch:m}),(0,l.SU)(p)?((0,o.wg)(),(0,o.j4)(s,{key:0,class:"u-add",type:"primary",onClick:i[0]||(i[0]=e=>f({type:"add"}))},{default:(0,o.w5)((()=>[T])),_:1})):(0,o.kq)("",!0)]),(0,o.wy)((0,o.Wm)((0,l.SU)(v),{table:(0,l.SU)(r).table,label:(0,l.SU)(t).label,onToDialog:f},null,8,["table","label"]),[[S,(0,l.SU)(r).loading]]),(0,o.Wm)(h,{pagination:(0,l.SU)(r).pagination,onToParams:g},null,8,["pagination"]),"tips"==(0,l.SU)(c)?((0,o.wg)(),(0,o.j4)(y,{key:0,class:"m-tips","dialog-object":(0,l.SU)(d),onDialogClose:b,onDialogSuccess:w},{default:(0,o.w5)((()=>[(0,o._)("div",N,[x,(0,o._)("span",null,(0,n.zw)((0,l.SU)(d).company.orgzName),1),(0,o._)("span",null,"企业ID: "+(0,n.zw)((0,l.SU)(d).company.organizationId),1)])])),_:1},8,["dialog-object"])):(0,o.kq)("",!0),"form"==(0,l.SU)(c)?((0,o.wg)(),(0,o.j4)((0,l.SU)(z),{key:1,class:"m-form","dialog-object":(0,l.SU)(d),onDialogClose:b,onDialogSuccess:_},null,8,["dialog-object"])):(0,o.kq)("",!0)])}}};const B=F;var P=B},4460:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return D}});var o=a(6252),l=a(2262),n=a(3577),i=a(8825),r=(a(6699),a(999)),u=a(9996);const s=e=>((0,o.dD)("data-v-e28ab87a"),e=e(),(0,o.Cn)(),e),c={class:"u-table-button"},d=["onClick"],p=s((()=>(0,o._)("span",null,"重置密码",-1))),m=(0,o.Uk)("查看详情 ");var g={__name:"customerTable",props:{table:Array,label:String},emits:["toDialog"],setup(e,{emit:t}){const a=e,s=(0,i.t)();let g=(0,l.qj)({data:[]});const f=(0,o.Fl)((()=>s.role.includes(17))),b=(0,o.Fl)((()=>s.role.includes(15))),v=[17,15],w=(0,o.Fl)((()=>s.role.map((e=>v.includes(e))).filter(Boolean).length));function h(e,a){t("toDialog",{row:e,type:a})}function _(e){(0,r.c0)(e).then((()=>{(0,u.bM)({type:"success",title:"成功",message:"重置密码成功"})}))}return(0,o.YP)(a,(e=>{g.data=e.table}),{deep:!0}),(t,a)=>{const i=(0,o.up)("el-table-column"),r=(0,o.up)("el-popconfirm"),u=(0,o.up)("router-link"),s=(0,o.up)("el-table");return(0,o.wg)(),(0,o.j4)(s,{class:"m-table",data:(0,l.SU)(g).data,border:"","row-key":"userId",fit:"",style:{width:"100%"}},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{prop:"userId",label:"用户ID",width:"120"}),(0,o.Wm)(i,{label:"用户账号",width:"180"},{default:(0,o.w5)((e=>[(0,o.Uk)((0,n.zw)(e.row.accountName||"-"),1)])),_:1}),(0,o.Wm)(i,{label:"手机号码",width:"180"},{default:(0,o.w5)((e=>[(0,o.Uk)((0,n.zw)(e.row.phoneNum||"-"),1)])),_:1}),(0,o.Wm)(i,{prop:"orgzName",label:"所在企业"}),(0,o.Wm)(i,{prop:"status",label:"帐号状态",width:"120"},{default:(0,o.w5)((e=>[(0,o._)("span",{class:(0,n.C_)("禁用"===e.row.status?"u-table-disabled":"u-table-normal")},(0,n.zw)("禁用"===e.row.status?"已停用":e.row.status),3)])),_:1}),(0,o.Wm)(i,{prop:"updateAt",label:"最近登录",width:"240"}),(0,l.SU)(w)?((0,o.wg)(),(0,o.j4)(i,{key:0,prop:"address",label:"操作",width:"240"},{default:(0,o.w5)((t=>[(0,o._)("div",c,[(0,l.SU)(b)?((0,o.wg)(),(0,o.iD)("span",{key:0,onClick:e=>h(t.row)},(0,n.zw)("正常"==t.row.status?"停用":"启用"),9,d)):(0,o.kq)("",!0),(0,l.SU)(b)?((0,o.wg)(),(0,o.j4)(r,{key:1,title:"是否重置密码？",onConfirm:e=>_(t.row.userId)},{reference:(0,o.w5)((()=>[p])),_:2},1032,["onConfirm"])):(0,o.kq)("",!0),(0,l.SU)(f)&&t.row.userId?((0,o.wg)(),(0,o.j4)(u,{key:2,to:{path:`/${e.label}/details/${t.row.userId}`},class:"u-table-more"},{default:(0,o.w5)((()=>[m])),_:2},1032,["to"])):(0,o.kq)("",!0)])])),_:1})):(0,o.kq)("",!0)])),_:1},8,["data"])}}},f=a(3744);const b=(0,f.Z)(g,[["__scopeId","data-v-e28ab87a"]]);var v=b;const w={class:"v-customer v-page"},h={class:"m-search-box"},_={class:"m-tips-content"},y=(0,o._)("span",{class:"u-title"},"是否启用/停用用户帐号",-1),S={class:"u-label"},k={class:"u-value"};var U={__name:"CustomerList",setup(e){const t=(0,i.t)(),a={uid:"",placeholder:"请输入用户ID/用户姓名/手机号码/所在成员名称",status_title:"-- 用户帐号状态 --",status:[{label:"全部",value:-1},{label:"正常",value:0},{label:"已停用",value:1}]};let s=(0,l.qj)({loading:!1,table:[],pagination:{page:1,per:20,total:0},search:{input:null,status:null},form:{}});const c=(0,o.Fl)((()=>({pageIndex:s.pagination.page-1,pageSize:s.pagination.per,Condition:s.search.input,Status:s.search.status}))),d={};let p=(0,l.iH)("form"),m=(0,l.qj)({dialogVisible:!1,customer:d});function g({input_txt:e,status_id:t}){s.search.input=e,s.search.status=-1==t?null:t,s.pagination.page=1,D()}function f(e){s.pagination.page=e,D()}function b({row:e,type:t}){m.dialogVisible=!0,m.customer=e||d,p.value="close"==t?"tips":"form"}const U=()=>{m.dialogVisible=!1},j=()=>{const{userId:e,status:t}=m.customer,a="正常"==t?1:0,o=1==a?"启用":"停用";(0,r.lz)(e,a).then((()=>{m.dialogVisible=!1,D(),(0,u.bM)({title:"成功",message:`${o}成员成功`,type:"success"})}))};function D(){s.loading=!0,(0,r.wN)(c.value).then((e=>{if("200"==e.status){const t=e.data.data;s.table=t.datas,s.pagination.total=t.totalCount}})).finally((()=>s.loading=!1))}return(0,o.bv)((()=>D())),(e,i)=>{const r=(0,o.up)("search-bar"),u=(0,o.up)("commonPagination"),c=(0,o.up)("tipsDialog"),d=(0,o.Q2)("loading");return(0,o.wg)(),(0,o.iD)("div",w,[(0,o._)("div",h,[(0,o.Wm)(r,{data:a,onToSearch:g})]),(0,o.wy)((0,o.Wm)((0,l.SU)(v),{table:(0,l.SU)(s).table,label:(0,l.SU)(t).label,onToDialog:b},null,8,["table","label"]),[[d,(0,l.SU)(s).loading]]),(0,o.Wm)(u,{pagination:(0,l.SU)(s).pagination,onToParams:f},null,8,["pagination"]),(0,o.Wm)(c,{class:"m-tips","dialog-object":(0,l.SU)(m),onDialogClose:U,onDialogSuccess:j},{default:(0,o.w5)((()=>[(0,o._)("div",_,[y,(0,o._)("span",S,(0,n.zw)((0,l.SU)(m).customer.orgzName),1),(0,o._)("span",k,"("+(0,n.zw)((0,l.SU)(m).customer.phoneNum)+")",1)])])),_:1},8,["dialog-object"])])}}};const j=U;var D=j},340:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return N}});a(6699);var o=a(6252),l=a(2262),n=a(8825),i=a(3577),r=a.p+"img/line.17d0375a.svg";const u={class:"m-icon"},s={key:0,class:"u-icon",src:r},c={key:1,class:"u-icon u-red"},d={class:"u-table-button"},p=(0,o.Uk)("查看详情 "),m=["onClick"];var g={__name:"equipmentTable",props:{table:Array,label:String},emits:["toDialog"],setup(e,{emit:t}){const a=e,r=(0,n.t)(),g=(0,o.Fl)((()=>r.role.includes(21))),f=(0,o.Fl)((()=>r.role.includes(20))),b=[20,21],v=(0,o.Fl)((()=>r.role.map((e=>b.includes(e))).filter(Boolean).length));let w=(0,l.qj)({data:[]});function h(e,a){t("toDialog",{row:e,type:a})}return(0,o.YP)(a,(e=>{w.data=e.table}),{deep:!0}),(t,a)=>{const n=(0,o.up)("el-table-column"),r=(0,o.up)("router-link"),b=(0,o.up)("el-table");return(0,o.wg)(),(0,o.j4)(b,{class:"m-table",data:(0,l.SU)(w).data,border:"","row-key":"deviceId",fit:"",style:{width:"100%"}},{default:(0,o.w5)((()=>[(0,o.Wm)(n,{prop:"deviceId",label:"设备ID"}),(0,o.Wm)(n,{label:"设备类型"},{default:(0,o.w5)((e=>[(0,o.Uk)((0,i.zw)(e.row.deviceType),1)])),_:1}),(0,o.Wm)(n,{prop:"orgzName",label:"归属企业"}),(0,o.Wm)(n,{prop:"hard_version",label:"硬件版本"}),(0,o.Wm)(n,{prop:"soft_version",label:"固件版本"}),(0,o.Wm)(n,{prop:"iccid",label:"ICCID"}),(0,o.Wm)(n,{label:"连接状态"},{default:(0,o.w5)((e=>[(0,o._)("div",u,[e.row.connectionStatus?((0,o.wg)(),(0,o.iD)("img",s)):((0,o.wg)(),(0,o.iD)("span",c))])])),_:1}),(0,o.Wm)(n,{label:"绑定状态"},{default:(0,o.w5)((e=>[(0,o._)("span",{class:(0,i.C_)("未绑定"==e.row.isBindNode?"u-table-disabled":"u-table-normal")},(0,i.zw)(e.row.isBindNode),3)])),_:1}),(0,o.Wm)(n,{prop:"deviceName",label:"备注"}),(0,o.Wm)(n,{prop:"tracking",label:"最新跟踪"}),(0,l.SU)(v)?((0,o.wg)(),(0,o.j4)(n,{key:0,label:"操作",width:"240"},{default:(0,o.w5)((t=>[(0,o._)("div",d,[(0,l.SU)(f)&&t.row.deviceId?((0,o.wg)(),(0,o.j4)(r,{key:0,to:{path:`/${e.label}/details/${t.row.deviceId}`},class:"u-table-more"},{default:(0,o.w5)((()=>[p])),_:2},1032,["to"])):(0,o.kq)("",!0),(0,l.SU)(g)?((0,o.wg)(),(0,o.iD)("span",{key:1,onClick:e=>h(t.row,"track")},"设备跟踪",8,m)):(0,o.kq)("",!0)])])),_:1})):(0,o.kq)("",!0)])),_:1},8,["data"])}}},f=a(3744);const b=(0,f.Z)(g,[["__scopeId","data-v-2c23a4c4"]]);var v=b;a(1703);const w={key:0,class:"dialog-footer"},h={emits:["dialogClose","dialogSuccess"]};var _=Object.assign(h,{__name:"equipmentFormDialog",props:{dialogObject:Object},setup(e,{emit:t}){const a=e,n=(0,o.Fl)({get(){return a.dialogObject.dialogVisible},set(e){return e}}),r=JSON.parse(localStorage.getItem("orgs")),u=JSON.parse(localStorage.getItem("types")),s=(0,o.Fl)((()=>({dialogTitle:a.dialogObject.title||"设备信息",dialogWidth:a.dialogObject.width||"760px",dialogCloseBtnText:a.dialogObject.closeBtnText||"取消",dialogSuccessBtnText:a.dialogObject.successBtnText||"确定",dialogIsFooter:a.dialogObject.isFooter||!0,dialogContent:a.dialogObject.content||"是否停用"})));let c=(0,l.qj)({form:{},handleSelect:{},add:!1});const d={DeviceId:"",DeviceTypeId:"",Orgzid:"",Name:""},p=(e,t,a)=>{""===t?a(new Error("请输入企业名称")):r.filter((e=>e.orgzName==c.form.Orgzid)).length?a():a(new Error("没有这个企业"))},m=(0,l.iH)(""),g=(0,l.iH)({DeviceId:[{required:!0,message:"请输入设备ID",trigger:"blur"}],DeviceTypeId:[{required:!0,message:"请选择设备类型",trigger:"change"}],Orgzid:[{required:!0,validator:p}]});(0,o.YP)(a,(({dialogObject:e})=>{const{equipment:t}=e;if(!t)return;const{id:a,deviceId:o,deviceName:l,deviceType:n,orgzId:i,orgzName:r,add:u}=t;u?(c.form={...d},c.add=!0):(c.form.id=a,c.form.DeviceId=o,c.form.DeviceTypeId="未知"==n?"":n,c.form.Orgzid=r,c.form.Name=l,c.add=!1)}),{deep:!0,immediate:!0});const f=()=>{m.value.resetFields(),t("dialogClose")},b=e=>{e&&e.validate(((e,a)=>{if(e){var o;let e={...c.form};e.Orgzid=r.map((e=>e.orgzName==c.form.Orgzid&&e)).filter(Boolean)[0].orgzId,e.DeviceTypeId=(null===(o=u.filter((e=>e.name==c.form.DeviceTypeId))[0])||void 0===o?void 0:o.id)||c.form.DeviceTypeId,e.add=c.add,t("dialogSuccess",e)}else console.log("error submit!",a)}))},v=(e,t)=>{const a=e?r.filter((t=>t.orgzName.includes(e))):r;t(a)},h=e=>{c.handleSelect=e};return(e,t)=>{const a=(0,o.up)("el-input"),r=(0,o.up)("el-form-item"),d=(0,o.up)("el-option"),p=(0,o.up)("el-select"),_=(0,o.up)("el-autocomplete"),y=(0,o.up)("el-form"),S=(0,o.up)("el-button"),k=(0,o.up)("el-dialog");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o.Wm)(k,{modelValue:(0,l.SU)(n),"onUpdate:modelValue":t[5]||(t[5]=e=>(0,l.dq)(n)?n.value=e:null),title:(0,l.SU)(s).dialogTitle,width:(0,l.SU)(s).dialogWidth,"before-close":f,draggable:""},{footer:(0,o.w5)((()=>[(0,l.SU)(s).dialogIsFooter?((0,o.wg)(),(0,o.iD)("span",w,[(0,o.Wm)(S,{onClick:f},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)((0,l.SU)(s).dialogCloseBtnText),1)])),_:1}),(0,o.Wm)(S,{type:"primary",onClick:t[4]||(t[4]=e=>b(m.value))},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)((0,l.SU)(s).dialogSuccessBtnText),1)])),_:1})])):(0,o.kq)("",!0)])),default:(0,o.w5)((()=>[(0,o.Wm)(y,{class:"m-form-content",ref_key:"formRef",ref:m,model:(0,l.SU)(c).form,rules:g.value,"label-width":"120px"},{default:(0,o.w5)((()=>[(0,o.Wm)(r,{label:"设备ID",prop:"DeviceId"},{default:(0,o.w5)((()=>[(0,o.Wm)(a,{modelValue:(0,l.SU)(c).form.DeviceId,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,l.SU)(c).form.DeviceId=e)},null,8,["modelValue"])])),_:1}),(0,o.Wm)(r,{label:"设备类型",prop:"DeviceTypeId"},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{modelValue:(0,l.SU)(c).form.DeviceTypeId,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,l.SU)(c).form.DeviceTypeId=e),placeholder:"- 请选择 -"},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,l.SU)(u),((e,t)=>((0,o.wg)(),(0,o.j4)(d,{key:t,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,o.Wm)(r,{label:"归属客户",prop:"Orgzid"},{default:(0,o.w5)((()=>[(0,o.Wm)(_,{modelValue:(0,l.SU)(c).form.Orgzid,"onUpdate:modelValue":t[2]||(t[2]=e=>(0,l.SU)(c).form.Orgzid=e),"fetch-suggestions":v,"value-key":"orgzName",placeholder:"",onSelect:h},null,8,["modelValue"])])),_:1}),(0,o.Wm)(r,{label:"备注"},{default:(0,o.w5)((()=>[(0,o.Wm)(a,{modelValue:(0,l.SU)(c).form.Name,"onUpdate:modelValue":t[3]||(t[3]=e=>(0,l.SU)(c).form.Name=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title","width"])])}}});const y=_;var S=y;const k={key:0,class:"dialog-footer"},U={emits:["dialogClose","dialogSuccess"]};var j=Object.assign(U,{__name:"equipmentTrackDialog",props:{dialogObject:Object},setup(e,{emit:t}){const a=e,n=(0,o.Fl)({get(){return a.dialogObject.dialogVisible},set(e){return e}}),r=(0,o.Fl)((()=>a.dialogObject.equipment)),u=(0,l.iH)(""),s=(0,o.Fl)((()=>({dialogTitle:a.dialogObject.title||"设备信息",dialogWidth:a.dialogObject.width||"760px",dialogCloseBtnText:a.dialogObject.closeBtnText||"取消",dialogSuccessBtnText:a.dialogObject.successBtnText||"确定",dialogIsFooter:a.dialogObject.isFooter||!0,dialogContent:a.dialogObject.content||"是否停用"}))),c=()=>{t("dialogClose")},d=()=>{if(u.value){const e={information:u.value,deviceId:r.value.deviceId};t("dialogSuccess",e)}else t("dialogClose")};return(e,t)=>{const a=(0,o.up)("el-form-item"),p=(0,o.up)("el-input"),m=(0,o.up)("el-form"),g=(0,o.up)("el-button"),f=(0,o.up)("el-dialog");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o.Wm)(f,{modelValue:(0,l.SU)(n),"onUpdate:modelValue":t[1]||(t[1]=e=>(0,l.dq)(n)?n.value=e:null),title:(0,l.SU)(s).dialogTitle,width:(0,l.SU)(s).dialogWidth,"before-close":c,draggable:""},{footer:(0,o.w5)((()=>[(0,l.SU)(s).dialogIsFooter?((0,o.wg)(),(0,o.iD)("span",k,[(0,o.Wm)(g,{onClick:c},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)((0,l.SU)(s).dialogCloseBtnText),1)])),_:1}),(0,o.Wm)(g,{type:"primary",onClick:d},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)((0,l.SU)(s).dialogSuccessBtnText),1)])),_:1})])):(0,o.kq)("",!0)])),default:(0,o.w5)((()=>[(0,o.Wm)(m,{class:"m-form-content",model:(0,l.SU)(r),"label-width":"120px"},{default:(0,o.w5)((()=>[(0,o.Wm)(a,{label:"设备ID",prop:"DeviceId"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)((0,l.SU)(r).deviceId),1)])),_:1}),(0,o.Wm)(a,{label:"设备归属",prop:"DeviceTypeId"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)((0,l.SU)(r).orgzName),1)])),_:1}),(0,o.Wm)(a,{label:"跟踪记录"},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=e=>u.value=e),rows:2,type:"textarea"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","title","width"])])}}});const D=j;var W=D,I=a(3727),O=a(2941),z=a(9996);const C={class:"v-equipment v-page"},V={class:"m-search-box"};var q={__name:"EquipmentList",setup(e){const t=(0,n.t)(),a=JSON.parse(localStorage.getItem("types"))||[];let i=(0,l.qj)({uid:"",placeholder:"请输入设备ID/ICCID/归属客户/备注/追踪记录",type_title:"-- 设备分类 --",type:[{id:-1,name:"全部"},...a],bind_title:"-- 绑定状态 --",bind:[{label:"全部",value:-1},{label:"已绑定",value:1},{label:"未绑定",value:0}]}),r=(0,l.qj)({loading:!1,table:[],pagination:{page:1,per:20,total:0},search:{Condition:null,DeviceTypeId:null,IsBindNode:null},form:{},track:!1});const u=(0,o.Fl)((()=>({pageIndex:r.pagination.page-1,pageSize:r.pagination.per,...r.search}))),s={};let c=(0,l.qj)({dialogVisible:!1,equipment:s});const d=(0,o.Fl)((()=>t.role.includes(19)));function p({input_txt:e,type_id:t,bind_id:a}){r.search.Condition=e,r.search.DeviceTypeId=-1==t?null:t,r.search.IsBindNode=-1==a?null:a,r.pagination.page=1,h()}function m(e){r.pagination.page=e,h()}const g=()=>{c.dialogVisible=!1};function f({row:e,type:t}){if(c.dialogVisible=!0,"track"==t)r.track=!0,c.equipment=e;else{r.track=!1;const a=e||s;"add"==t&&(a.add=!0),c.equipment=a}}const b=e=>{(0,I.i2)(e).then((()=>{c.dialogVisible=!1,(0,z.bM)({title:"成功",message:"添加设备追踪记录成功",type:"success"})}))},w=e=>{c.dialogVisible=!1,e.add?(0,I.ag)(e).then((()=>{(0,z.bM)({title:"成功",message:"添加设备成功",type:"success"}),h()})):(0,I.Ol)(e).then((()=>{(0,z.bM)({title:"成功",message:"修改设备信息成功",type:"success"}),h()}))};function h(){r.loading=!0,(0,I.eM)(u.value).then((e=>{if("200"==e.status){const t=e.data.data;r.table=t.datas,r.pagination.total=t.totalCount}})).finally((()=>r.loading=!1))}return(0,o.bv)((()=>h())),localStorage.getItem("types")||(0,I.cB)().then((e=>{const t=e.data.data;i.type=t.reverse(),localStorage.setItem("types",JSON.stringify(t))})),(0,O.yG)().then((e=>{const t=e.data.data;localStorage.setItem("orgs",JSON.stringify(t))})),(e,a)=>{const n=(0,o.up)("search-bar"),u=((0,o.up)("el-button"),(0,o.up)("commonPagination")),s=(0,o.Q2)("loading");return(0,o.wg)(),(0,o.iD)("div",C,[(0,o._)("div",V,[(0,o.Wm)(n,{data:(0,l.SU)(i),onToSearch:p},null,8,["data"]),((0,l.SU)(d),(0,o.kq)("",!0))]),(0,o.wy)((0,o.Wm)((0,l.SU)(v),{table:(0,l.SU)(r).table,label:(0,l.SU)(t).label,onToDialog:f},null,8,["table","label"]),[[s,(0,l.SU)(r).loading]]),(0,o.Wm)(u,{pagination:(0,l.SU)(r).pagination,onToParams:m},null,8,["pagination"]),(0,l.SU)(r).track?((0,o.wg)(),(0,o.j4)((0,l.SU)(W),{key:0,class:"m-form","dialog-object":(0,l.SU)(c),onDialogClose:g,onDialogSuccess:b},null,8,["dialog-object"])):((0,o.wg)(),(0,o.j4)((0,l.SU)(S),{key:1,class:"m-form","dialog-object":(0,l.SU)(c),onDialogClose:g,onDialogSuccess:w},null,8,["dialog-object"]))])}}};const T=q;var N=T},4654:function(){}},t={};function a(o){var l=t[o];if(void 0!==l)return l.exports;var n=t[o]={id:o,loaded:!1,exports:{}};return e[o].call(n.exports,n,n.exports,a),n.loaded=!0,n.exports}a.m=e,function(){var e=[];a.O=function(t,o,l,n){if(!o){var i=1/0;for(c=0;c<e.length;c++){o=e[c][0],l=e[c][1],n=e[c][2];for(var r=!0,u=0;u<o.length;u++)(!1&n||i>=n)&&Object.keys(a.O).every((function(e){return a.O[e](o[u])}))?o.splice(u--,1):(r=!1,n<i&&(i=n));if(r){e.splice(c--,1);var s=l();void 0!==s&&(t=s)}}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[o,l,n]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var o in t)a.o(t,o)&&!a.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){a.f={},a.e=function(e){return Promise.all(Object.keys(a.f).reduce((function(t,o){return a.f[o](e,t),t}),[]))}}(),function(){a.u=function(e){return"js/"+e+"."+{306:"2cc1508a",795:"a35bac0a",912:"9dc0517b",929:"718201e1"}[e]+".js"}}(),function(){a.miniCssF=function(e){return"css/"+e+"."+{306:"7ecabb0b",795:"41cfa0b7",912:"3dd01bbf",929:"5bbb4f6b"}[e]+".css"}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="omp:";a.l=function(o,l,n,i){if(e[o])e[o].push(l);else{var r,u;if(void 0!==n)for(var s=document.getElementsByTagName("script"),c=0;c<s.length;c++){var d=s[c];if(d.getAttribute("src")==o||d.getAttribute("data-webpack")==t+n){r=d;break}}r||(u=!0,r=document.createElement("script"),r.charset="utf-8",r.timeout=120,a.nc&&r.setAttribute("nonce",a.nc),r.setAttribute("data-webpack",t+n),r.src=o),e[o]=[l];var p=function(t,a){r.onerror=r.onload=null,clearTimeout(m);var l=e[o];if(delete e[o],r.parentNode&&r.parentNode.removeChild(r),l&&l.forEach((function(e){return e(a)})),t)return t(a)},m=setTimeout(p.bind(null,void 0,{type:"timeout",target:r}),12e4);r.onerror=p.bind(null,r.onerror),r.onload=p.bind(null,r.onload),u&&document.head.appendChild(r)}}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){a.p="https://cdn.deepberry.cn/static/omp/"}(),function(){var e=function(e,t,a,o){var l=document.createElement("link");l.rel="stylesheet",l.type="text/css";var n=function(n){if(l.onerror=l.onload=null,"load"===n.type)a();else{var i=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.href||t,u=new Error("Loading CSS chunk "+e+" failed.\n("+r+")");u.code="CSS_CHUNK_LOAD_FAILED",u.type=i,u.request=r,l.parentNode.removeChild(l),o(u)}};return l.onerror=l.onload=n,l.href=t,document.head.appendChild(l),l},t=function(e,t){for(var a=document.getElementsByTagName("link"),o=0;o<a.length;o++){var l=a[o],n=l.getAttribute("data-href")||l.getAttribute("href");if("stylesheet"===l.rel&&(n===e||n===t))return l}var i=document.getElementsByTagName("style");for(o=0;o<i.length;o++){l=i[o],n=l.getAttribute("data-href");if(n===e||n===t)return l}},o=function(o){return new Promise((function(l,n){var i=a.miniCssF(o),r=a.p+i;if(t(i,r))return l();e(o,r,l,n)}))},l={143:0};a.f.miniCss=function(e,t){var a={306:1,795:1,912:1,929:1};l[e]?t.push(l[e]):0!==l[e]&&a[e]&&t.push(l[e]=o(e).then((function(){l[e]=0}),(function(t){throw delete l[e],t})))}}(),function(){var e={143:0};a.f.j=function(t,o){var l=a.o(e,t)?e[t]:void 0;if(0!==l)if(l)o.push(l[2]);else{var n=new Promise((function(a,o){l=e[t]=[a,o]}));o.push(l[2]=n);var i=a.p+a.u(t),r=new Error,u=function(o){if(a.o(e,t)&&(l=e[t],0!==l&&(e[t]=void 0),l)){var n=o&&("load"===o.type?"missing":o.type),i=o&&o.target&&o.target.src;r.message="Loading chunk "+t+" failed.\n("+n+": "+i+")",r.name="ChunkLoadError",r.type=n,r.request=i,l[1](r)}};a.l(i,u,"chunk-"+t,t)}},a.O.j=function(t){return 0===e[t]};var t=function(t,o){var l,n,i=o[0],r=o[1],u=o[2],s=0;if(i.some((function(t){return 0!==e[t]}))){for(l in r)a.o(r,l)&&(a.m[l]=r[l]);if(u)var c=u(a)}for(t&&t(o);s<i.length;s++)n=i[s],a.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return a.O(c)},o=self["webpackChunkomp"]=self["webpackChunkomp"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=a.O(void 0,[998],(function(){return a(6128)}));o=a.O(o)})();
//# sourceMappingURL=app.98e49afa.js.map