{"version":3,"file":"js/575.39caec84.js","mappings":"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","sources":["webpack://omp/./src/service/manage.js","webpack://omp/./src/components/table/memberTable.vue","webpack://omp/./src/components/table/memberTable.vue?96fe","webpack://omp/./src/components/dialog/userRoleFormDialog.vue","webpack://omp/./src/components/dialog/userRoleFormDialog.vue?1693","webpack://omp/./src/service/member.js","webpack://omp/./src/views/MemberList.vue","webpack://omp/./src/views/MemberList.vue?e7d1"],"sourcesContent":["import { $admin } from \"./axios.js\";\n\n// 获取用户信息（本账号）\nfunction getUserInfo() {\n    return $admin().get(`/api/Work/userInfo`);\n}\n\n// 添加角色\nfunction addRole(data) {\n    return $admin().post(`/api/Manage/role`, data);\n}\n\n// 更新角色\nfunction editRole(data) {\n    return $admin().put(`/api/Manage/role`, data);\n}\n\n// 删除角色\nfunction delRole(id) {\n    return $admin().delete(`/api/Manage/role/${id}`);\n}\n\n// 获取所有角色\nfunction getRoles() {\n    return $admin().get(`/api/Manage/role`);\n}\n\n// 获取指定角色\nfunction getRoleId(id) {\n    return $admin().get(`/api/Manage/role/${id}`);\n}\n\n// 设置角色权限\nfunction setRolePermission({ id, prmIds }) {\n    return $admin().post(`/api/Manage/role/${id}/permission`, { prmIds });\n}\n\n// 获取所有权限\nfunction getRolePermission() {\n    return $admin().get(`/api/Manage/permission`);\n}\n\n// 获取指定权限\nfunction getRolePermissionId(id) {\n    return $admin().get(`/api/Manage/permission/${id}`);\n}\n\n// 设置用户角色\nfunction setUserPermission(id) {\n    return $admin().get(`/api/Manage/uer/${id}/role`);\n}\n\nexport {\n    getUserInfo,\n    addRole,\n    editRole,\n    delRole,\n    getRoles,\n    getRoleId,\n    setRolePermission,\n    getRolePermission,\n    getRolePermissionId,\n    setUserPermission,\n};\n","<template>\n    <el-table class=\"m-table\" :data=\"table\" border style=\"width: 100%\">\n        <el-table-column prop=\"userId\" label=\"userId\" />\n        <el-table-column prop=\"name\" label=\"姓名\" width=\"180\" />\n        <el-table-column prop=\"mobile\" label=\"手机号码\" width=\"180\" />\n        <el-table-column prop=\"address\" label=\"部门\" />\n        <el-table-column prop=\"role\" label=\"角色\" width=\"120\" />\n        <el-table-column prop=\"disabled\" label=\"状态\" width=\"120\">\n            <template #default=\"scope\">\n                <span :class=\"scope.row.disabled === '正常' ? 'u-table-normal' : 'u-table-disabled'\">\n                    {{ scope.row.disabled }}</span\n                >\n            </template>\n        </el-table-column>\n        <el-table-column label=\"操作\">\n            <template #default=\"scope\">\n                <div class=\"u-table-button\">\n                    <el-button link type=\"primary\" size=\"small\" @click=\"handelClick(scope.row, 'close')\"\n                        >停用</el-button\n                    >\n                    <el-button link type=\"primary\" size=\"small\" @click=\"handelClick(scope.row, 'role')\"\n                        >授权角色权限\n                    </el-button>\n                </div>\n            </template>\n        </el-table-column>\n    </el-table>\n</template>\n<script setup>\nimport { defineProps, defineEmits, watch, reactive } from \"vue\";\n//====== 数据 ======\n// props\nconst props = defineProps({\n    table: Array,\n});\nconst emit = defineEmits([\"toDialog\"]);\n\n// 表格data数据\nlet state = reactive({\n    data: [],\n});\n// 监控表格数据\nwatch(\n    props,\n    (obj) => {\n        state.data = obj.table;\n        console.log(obj);\n    },\n    { deep: true }\n);\n//====== 交互 ======\n// 提交企业id和弹窗类型\nfunction handelClick(row, type) {\n    emit(\"toDialog\", { row, type });\n}\n</script>\n<style lang=\"less\" scoped>\n@import \"@/assets/css/components/table.less\";\n</style>\n","import script from \"./memberTable.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./memberTable.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./memberTable.vue?vue&type=style&index=0&id=00a44f02&lang=less&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/omp/omp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-00a44f02\"]])\n\nexport default __exports__","<template>\n    <div>\n        <el-dialog\n            v-model=\"dialogShow\"\n            :title=\"obj.dialogTitle\"\n            :width=\"obj.dialogWidth\"\n            :before-close=\"close\"\n            draggable\n        >\n            <el-form class=\"m-form-content\" :model=\"obj.dialogForm\" label-width=\"120px\">\n                <el-form-item label=\"姓名\">\n                    {{ obj.dialogForm.name || \"-\" }}\n                </el-form-item>\n                <el-form-item label=\"手机号码\">\n                    {{ obj.dialogForm.mobile || \"-\" }}\n                </el-form-item>\n                <el-form-item label=\"授权角色\">\n                    <el-select v-model=\"obj.dialogForm.role\" placeholder=\"请选择角色\">\n                        <el-option v-for=\"(item, i) in roles\" :key=\"i\" :label=\"item.name\" :value=\"item.role\" />\n                    </el-select>\n                </el-form-item>\n            </el-form>\n            <template #footer>\n                <span v-if=\"obj.dialogIsFooter\" class=\"dialog-footer\">\n                    <el-button @click=\"close\">{{ obj.dialogCloseBtnText }}</el-button>\n                    <el-button type=\"primary\" @click=\"success\">{{ obj.dialogSuccessBtnText }}</el-button>\n                </span>\n            </template>\n        </el-dialog>\n    </div>\n</template>\n<script setup>\nimport { defineProps, defineEmits, computed } from \"vue\";\n//====== 数据 ======\n\n// props\nconst props = defineProps({\n    dialogObject: Object,\n});\nconst emit = defineEmits();\n\n// 弹窗显示\nconst dialogShow = computed({\n    get() {\n        return props.dialogObject.dialogVisible;\n    },\n    set(val) {\n        return val;\n    },\n});\n\n// 显示数据\nconst roles = computed(() => props.dialogObject.role);\nconst obj = computed(() => {\n    return {\n        dialogTitle: props.dialogObject.title || \"角色权限\",\n        dialogWidth: props.dialogObject.width || \"760px\",\n        dialogCloseBtnText: props.dialogObject.closeBtnText || \"取消\",\n        dialogSuccessBtnText: props.dialogObject.successBtnText || \"成功\",\n        dialogIsFooter: props.dialogObject.isFooter || true,\n        dialogContent: props.dialogObject.content || \"是否停用\",\n        dialogForm: props.dialogObject.member || {},\n    };\n});\n\n//====== 互动 ======\n\n// 取消关闭\nconst close = () => {\n    emit(\"dialogClose\");\n};\n// 成功\nconst success = () => {\n    emit(\"dialogSuccess\", obj.value.dialogForm);\n};\n</script>\n<script>\nexport default {\n    emits: [\"dialogClose\", \"dialogSuccess\"],\n};\n</script>\n<style lang=\"less\">\n@import \"@/assets/css/components/dialog.less\";\n</style>\n","import script from \"./userRoleFormDialog.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./userRoleFormDialog.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./userRoleFormDialog.vue?vue&type=style&index=0&id=778078f6&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { $admin } from \"./axios.js\";\n\nfunction getMemberList(params) {\n    return $admin().get(`/api/Manage/user`, { params });\n}\n// 设置用户停用、启用\nfunction setUserEnabled({ userId, enabled }) {\n    return $admin().put(`/api/Manage/uer/${userId}/enabled/${enabled}`);\n}\nexport { getMemberList, setUserEnabled };\n","<template>\n    <div class=\"m-member v-page\">\n        <!-- 搜索 -->\n        <div class=\"m-search-box\">\n            <search-bar :data=\"member_data\" @toSearch=\"onToSearch\" />\n        </div>\n        <!-- 表格 -->\n        <memberTable :table=\"state.table\" @toDialog=\"onToDialog\" v-loading=\"state.loading\" />\n        <!-- 分页 -->\n        <common-pagination :pagination=\"state.pagination\" @toParams=\"onToParams\" />\n        <!-- 提示弹窗 -->\n        <tipsDialog\n            class=\"m-tips\"\n            :dialog-object=\"dialogObject\"\n            @dialogClose=\"onDialogClose\"\n            @dialogSuccess=\"onTipsSuccess\"\n            v-if=\"dialogType == 'tips'\"\n        >\n            <div class=\"m-tips-content\">\n                <span class=\"u-title\">是否启用/停用成员帐号</span>\n                <span>{{ dialogObject.member.name }}</span>\n                <span>{{ dialogObject.member.role }}</span>\n                <span>{{ dialogObject.member.mobile }}</span>\n            </div>\n        </tipsDialog>\n        <!-- 授权 弹窗 -->\n        <userRoleFormDialog\n            class=\"m-form\"\n            :dialog-object=\"dialogObject\"\n            @dialogClose=\"onDialogClose\"\n            @dialogSuccess=\"onFormSuccess\"\n            v-if=\"dialogType == 'role'\"\n        />\n    </div>\n</template>\n<script setup>\nimport { reactive, ref, computed, onMounted } from \"vue\";\nimport memberTable from \"@/components/table/memberTable\";\nimport userRoleFormDialog from \"@/components/dialog/userRoleFormDialog\";\nimport { getMemberList, setUserEnabled } from \"@/service/member\";\nimport { getRoles } from \"@/service/manage\";\n//====== 数据 ======\n\n// 搜索 默认选项数据\nconst member_data = computed(() => {\n    return {\n        uid: \"\",\n        placeholder: `按姓名、手机号码查找`,\n        status_title: \"-- 状态 --\",\n        status: [\n            {\n                label: \"全部\",\n                value: -1,\n            },\n            {\n                label: \"正常\",\n                value: 0,\n            },\n            {\n                label: \"已停用\",\n                value: 1,\n            },\n        ],\n        role_title: \"-- 角色 --\",\n        role: [\n            {\n                label: \"全部\",\n                value: -1,\n            },\n            ...state.role,\n        ],\n    };\n});\n\n// 表格 翻页\nlet state = reactive({\n    loading: false,\n    table: [],\n    pagination: {\n        page: 1,\n        per: 20,\n        total: 0,\n    },\n    search: {\n        Condition: null,\n        Status: null,\n        RoleId: null,\n    },\n    form: {},\n    role: [],\n});\n\n// axios查询数据\nconst params = computed(() => {\n    return {\n        pageIndex: state.pagination.page - 1,\n        pageSize: state.pagination.per,\n        ...state.search,\n    };\n});\n\n// 默认表单\nconst member = {};\n\n// 弹窗\nlet dialogType = ref(\"form\");\nlet dialogObject = reactive({\n    dialogVisible: false,\n    member: member,\n    role: state.role,\n});\n//====== 交互 ======\n\n// 搜索查询\nconst onToSearch = ({ input_txt, status_id, role_id }) => {\n    state.search.Condition = input_txt;\n    state.search.Status = status_id == -1 ? null : status_id;\n    state.search.RoleId = role_id == -1 ? null : role_id;\n    state.pagination.page = 1;\n    loadEMemberList();\n};\n\n// 翻页页码并搜索新的列表\nconst onToParams = (e) => {\n    state.pagination.page = e;\n    loadEMemberList();\n};\n\n// 关闭弹窗\nconst onDialogClose = () => {\n    dialogObject.dialogVisible = false;\n};\n\n// 打开弹窗\nconst onToDialog = ({ row, type }) => {\n    dialogObject.dialogVisible = true;\n    console.log(row);\n    const _row = row ? row : member;\n    if (type == \"add\") _row.add = true;\n    dialogObject.member = _row;\n    dialogType.value = type == \"close\" ? \"tips\" : \"role\";\n};\n// 表单弹窗确定\nconst onFormSuccess = (form) => {\n    dialogObject.dialogVisible = false;\n    form;\n    // form.add\n    //     ? addEquipment(form).then(() => {\n    //           ElNotification({\n    //               title: \"成功\",\n    //               message: \"添加设备成功\",\n    //               type: \"success\",\n    //           });\n    //       })\n    //     : editEquipment(form).then(() => {\n    //           ElNotification({\n    //               title: \"成功\",\n    //               message: \"修改设备信息成功\",\n    //               type: \"success\",\n    //           });\n    //       });\n};\n// 提示弹窗确定\nconst onTipsSuccess = () => {\n    const enabled = dialogObject.member.disabled == \"正常\" ? 1 : 0;\n    setUserEnabled({ userId: dialogObject.member.userId, enabled }).then((res) => {\n        console.log(res);\n    });\n};\n\n//====== axios数据 ======\n\n// 初始加载\nonMounted(() => loadData());\n\n// 获取初始数据\nconst loadData = () => {\n    loadEMemberList();\n    loadRole();\n};\n// 获取成员列表\nconst loadEMemberList = () => {\n    state.loading = true;\n    getMemberList(params.value)\n        .then((res) => {\n            if (res.status == \"200\") {\n                const data = res.data.data;\n                state.table = data.datas;\n                state.pagination.total = data.totalCount;\n            }\n        })\n        .finally(() => (state.loading = false));\n};\n// 加载role列表\nconst loadRole = () => {\n    getRoles().then((res) => {\n        state.role = res.data.data.map((item) => {\n            item.label = item.name;\n            item.value = item.roleId;\n            return item;\n        });\n    });\n};\n</script>\n","import script from \"./MemberList.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./MemberList.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["getUserInfo","$admin","get","addRole","data","post","editRole","put","delRole","id","delete","getRoles","getRoleId","setRolePermission","prmIds","getRolePermission","state","reactive","handelClick","row","type","emit","watch","props","obj","table","console","log","deep","__exports__","emits","dialogShow","computed","dialogObject","dialogVisible","set","val","roles","role","dialogTitle","title","dialogWidth","width","dialogCloseBtnText","closeBtnText","dialogSuccessBtnText","successBtnText","dialogIsFooter","isFooter","dialogContent","content","dialogForm","member","close","success","value","getMemberList","params","setUserEnabled","userId","enabled","member_data","uid","placeholder","status_title","status","label","role_title","loading","pagination","page","per","total","search","Condition","Status","RoleId","form","pageIndex","pageSize","dialogType","ref","onToSearch","input_txt","status_id","role_id","loadEMemberList","onToParams","e","onDialogClose","onToDialog","_row","add","onFormSuccess","onTipsSuccess","disabled","then","res","onMounted","loadData","loadRole","datas","totalCount","finally","map","item","name","roleId"],"sourceRoot":""}